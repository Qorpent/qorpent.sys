define("the-root",[],function(){var e={},t=function(n){return n&&n(t,e),t},n=setTimeout;"undefined"!=typeof window&&(n=window.setTimeout);var i=function(e){n(e,4)};t.timeout=n,t.tick=i,t.checkEnvironment=function(){if("undefined"!=typeof window){if("undefined"==typeof t.$angular&&window.angular&&(t.$angular=t.$angular||window.angular,"undefined"==typeof t.$angular.$__http)){t.$angular.module("THE_ANGULAR_STUB",[]);var e=angular.injector(["THE_ANGULAR_STUB","ng"]);t.$angular.$__http=e.get("$http")}t.$jQuery=t.$jQuery||window.$}},t.localStorage={map:{},setItem:function(e,t){this.map[e]=t},getItem:function(e){return this.map[e]},clear:function(){this.map={}}};var r=new Date,o="DT."+r.getFullYear()+"."+r.getMonth()+"."+r.getDate()+"."+r.getHours();if(t.ver=o,"undefined"!=typeof document){var s=document.querySelector("head script[data-main]");if(s){var a=s.getAttribute("data-main");a&&(t.ver=a.match(/\?(.+)$/)||t.ver)}}return t}),define("the-md5",[],function(){function e(e){for(str="",j=0;j<=3;j++)str+=p.charAt(e>>8*j+4&15)+p.charAt(e>>8*j&15);return str}function t(e){for(nblk=(e.length+8>>6)+1,blks=new Array(16*nblk),i=0;i<16*nblk;i++)blks[i]=0;for(i=0;i<e.length;i++)blks[i>>2]|=e.charCodeAt(i)<<i%4*8;return blks[i>>2]|=128<<i%4*8,blks[16*nblk-2]=8*e.length,blks}function n(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n}function r(e,t){return e<<t|e>>>32-t}function o(e,t,i,o,s,a){return n(r(n(n(t,e),n(o,a)),s),i)}function s(e,t,n,i,r,s,a){return o(t&n|~t&i,e,t,r,s,a)}function u(e,t,n,i,r,s,a){return o(t&i|n&~i,e,t,r,s,a)}function l(e,t,n,i,r,s,a){return o(t^n^i,e,t,r,s,a)}function h(e,t,n,i,r,s,a){return o(n^(t|~i),e,t,r,s,a)}function f(r){for(x=t(r),a=1732584193,b=-271733879,c=-1732584194,d=271733878,i=0;i<x.length;i+=16)olda=a,oldb=b,oldc=c,oldd=d,a=s(a,b,c,d,x[i+0],7,-680876936),d=s(d,a,b,c,x[i+1],12,-389564586),c=s(c,d,a,b,x[i+2],17,606105819),b=s(b,c,d,a,x[i+3],22,-1044525330),a=s(a,b,c,d,x[i+4],7,-176418897),d=s(d,a,b,c,x[i+5],12,1200080426),c=s(c,d,a,b,x[i+6],17,-1473231341),b=s(b,c,d,a,x[i+7],22,-45705983),a=s(a,b,c,d,x[i+8],7,1770035416),d=s(d,a,b,c,x[i+9],12,-1958414417),c=s(c,d,a,b,x[i+10],17,-42063),b=s(b,c,d,a,x[i+11],22,-1990404162),a=s(a,b,c,d,x[i+12],7,1804603682),d=s(d,a,b,c,x[i+13],12,-40341101),c=s(c,d,a,b,x[i+14],17,-1502002290),b=s(b,c,d,a,x[i+15],22,1236535329),a=u(a,b,c,d,x[i+1],5,-165796510),d=u(d,a,b,c,x[i+6],9,-1069501632),c=u(c,d,a,b,x[i+11],14,643717713),b=u(b,c,d,a,x[i+0],20,-373897302),a=u(a,b,c,d,x[i+5],5,-701558691),d=u(d,a,b,c,x[i+10],9,38016083),c=u(c,d,a,b,x[i+15],14,-660478335),b=u(b,c,d,a,x[i+4],20,-405537848),a=u(a,b,c,d,x[i+9],5,568446438),d=u(d,a,b,c,x[i+14],9,-1019803690),c=u(c,d,a,b,x[i+3],14,-187363961),b=u(b,c,d,a,x[i+8],20,1163531501),a=u(a,b,c,d,x[i+13],5,-1444681467),d=u(d,a,b,c,x[i+2],9,-51403784),c=u(c,d,a,b,x[i+7],14,1735328473),b=u(b,c,d,a,x[i+12],20,-1926607734),a=l(a,b,c,d,x[i+5],4,-378558),d=l(d,a,b,c,x[i+8],11,-2022574463),c=l(c,d,a,b,x[i+11],16,1839030562),b=l(b,c,d,a,x[i+14],23,-35309556),a=l(a,b,c,d,x[i+1],4,-1530992060),d=l(d,a,b,c,x[i+4],11,1272893353),c=l(c,d,a,b,x[i+7],16,-155497632),b=l(b,c,d,a,x[i+10],23,-1094730640),a=l(a,b,c,d,x[i+13],4,681279174),d=l(d,a,b,c,x[i+0],11,-358537222),c=l(c,d,a,b,x[i+3],16,-722521979),b=l(b,c,d,a,x[i+6],23,76029189),a=l(a,b,c,d,x[i+9],4,-640364487),d=l(d,a,b,c,x[i+12],11,-421815835),c=l(c,d,a,b,x[i+15],16,530742520),b=l(b,c,d,a,x[i+2],23,-995338651),a=h(a,b,c,d,x[i+0],6,-198630844),d=h(d,a,b,c,x[i+7],10,1126891415),c=h(c,d,a,b,x[i+14],15,-1416354905),b=h(b,c,d,a,x[i+5],21,-57434055),a=h(a,b,c,d,x[i+12],6,1700485571),d=h(d,a,b,c,x[i+3],10,-1894986606),c=h(c,d,a,b,x[i+10],15,-1051523),b=h(b,c,d,a,x[i+1],21,-2054922799),a=h(a,b,c,d,x[i+8],6,1873313359),d=h(d,a,b,c,x[i+15],10,-30611744),c=h(c,d,a,b,x[i+6],15,-1560198380),b=h(b,c,d,a,x[i+13],21,1309151649),a=h(a,b,c,d,x[i+4],6,-145523070),d=h(d,a,b,c,x[i+11],10,-1120210379),c=h(c,d,a,b,x[i+2],15,718787259),b=h(b,c,d,a,x[i+9],21,-343485551),a=n(a,olda),b=n(b,oldb),c=n(c,oldc),d=n(d,oldd);return e(a)+e(b)+e(c)+e(d)}var p="0123456789abcdef";return f}),define("the-object",["the-root"],function(e){return e(function(t){var n=function(e){return this instanceof n?(this.defaultOnNull=!1,this.ignoreCase=!1,this.extensions=!0,this.deep=!1,this.clone=!1,this.cloneInternals=!1,this.functions=!0,this.preservefalse=!1,this.filter=function(e){return!!e},e&&t.object.extend(this,e),this):e instanceof n?e:new n(e)};n.Default=new n,n.DefaultCreate=new n,n.DefaultCreate.extensions=!1,n.DefaultClone=new n,n.DefaultClone.cloneInternals=!0,n.DefaultCast=new n,n.DefaultCast.extensions=!1,n.DefaultCast.defaultOnNull=!0,n.DefaultCast.ignoreCase=!0,n.DefaultCast.cloneInternals=!0,n.ExtendedCast=new n,n.ExtendedCast.extensions=!0,n.ExtendedCast.deep=!0,n.ExtendedCast.defaultOnNull=!0,n.ExtendedCast.ignoreCase=!0,n.ExtendedCast.cloneInternals=!0,t.object=t.object||{},t.object.ExtendOptions=n;{var i=t.object.toHex=function(e){for(var t=((0>e?8:0)+(e>>28&7)).toString(16)+(268435455&e).toString(16);t.length<8;)t="0"+t;return t},r=t.object.fixedOrder=function(e){if(null==e)return null;if(Array.isArray(e))return e;if("function"==typeof e)return e;if("object"!=typeof e)return e;var t={},n=[];for(var i in e)e.hasOwnProperty(i)&&n.push(i);n.sort();for(var i=0;i<n.length;i++)t[n[i]]=e[n[i]];return t};t.object.equal=function(e,n){return t.object.digest(e)==t.object.digest(n)}}t.object.digest=function(e){for(var t=[],n=0;2>n;n++)t.push(268803292*n);var o=JSON.stringify(r(e));for(n=0;n<o.length;n++)for(c=0;c<t.length;c++)t[c]=(t[c]<<13)-(t[c]>>19),t[c]+=o.charCodeAt(n)<<t[c]%24,t[c]=t[c]&t[c];for(n=0;n<t.length;n++)t[n]=i(t[n]);return t.join("")},t.object.extend=function(e,t,i){if(i=n(i)||n.Default,i.clone&&(e=s.extend({},e,n.DefaultClone)),"undefined"==typeof t||null===t)return e;var r,a={},u={};for(r in e)e.hasOwnProperty(r)&&(a[r]=r,i.ignoreCase&&(a[r.toLowerCase()]=r));for(r in t)t.hasOwnProperty(r)&&i.filter(r,t[r],t)&&(i.functions||"function"!=typeof t[r])&&(u[r]=r.toLowerCase());for(r in u)if(u.hasOwnProperty(r)){var c=!1,l=a[r];if("undefined"==typeof l&&(l=a[r.toLowerCase()]),"undefined"!=typeof l&&(c=!0),!c&&i.extensions&&(l=r),"undefined"!=typeof l){var h=t[r];if(i.cloneInternals&&o(e[l])&&(e[l]=s.clone(e[l])),i.cloneInternals&&o(h)&&(h=s.clone(h)),c&&i.deep&&o(e[l])&&o(h))s.extend(e[l],h,i);else{if(e[l]===!1&&1==h&&i.preservefalse)continue;e[l]=h}}}return e},t.isDefaultValue=function(e){if(null===e)return!0;if(""===e)return!0;if(0===e)return!0;if(!1===e)return!0;if(Array.isArray(e)&&0==e.length)return!0;if(t.isUserObject(e)){var n=!1;for(var i in e)if(e.hasOwnProperty(i)){n=!0;break}return!n}return!1},t.isUserObject=t.object.isUserObject=function(e){return"undefined"==typeof e||null===e?!1:"object"!=typeof e?!1:e instanceof RegExp?!1:!(e instanceof Date)};var o=t.isUserObject,s=t.object;t.object.create=function(e,t,i){i=i||n.DefaultCreate;var r;if(Array.isArray(t)){r=Object.create(e.prototype);var o=e.__parse__||e.prototype.__parse__;return o&&1==t.length&&"string"==typeof t[0]?(e.apply(r,[]),o.apply(r,[t[0]])):e.apply(r,t),r}return"function"==typeof t?(r=t(e),s.cast(e,r)):"object"!=typeof t||t instanceof RegExp?s.cast(e,[t]):(r=Object.create(e.prototype),e.apply(r,[]),s.extend(r,t,i),r)},t.object.cast=function(e,i,r){return i instanceof e?i:(r=r||n.DefaultCast,null==i||"undefined"==typeof i?r.defaultOnNull?s.create(e,[]):null:t.object.create(e,i,r))},t.object.propertise=function(e){for(var t in e)e.hasOwnProperty(t)&&"object"==typeof e[t]&&"get"in e[t]&&Object.defineProperty(e,t,e[t]);return e},t.object.clone=function(i){if(Array.isArray(i)){for(var r=[],o=0;o<i.length;o++)r.push(t.object.clone(i[o]));return r}return"undefined"!=i&&null!=i&&e.isUserObject(i)?s.extend({},i,n.DefaultClone):i},t.cast=t.object.cast,t.extend=t.object.extend,t.create=t.object.create,t.clone=t.object.clone,t.digest=t.object.digest})}),define("the-interpolation",["the-object"],function(e){return e(function(t,n){var i=n.__interpolateString=function(e,t,n){return e.replace(n.getRegex(),function(e){var i=e.substring(2,e.length-1),r=n.isLayeredDictionary?t.get(i):t[i];return"undefined"==typeof r?e:(null===r?r="":"function"==typeof r?r=r.apply(t,[]):"object"==typeof r&&(r=JSON.stringify(r)),r)})},r=n.__interpolateObject=function(t,n,u){for(var c,l=e.clone(t),h=a(l,n,u),f=3;;){if(0==(f-=1))break;s(l,h,u);var d=o(l,u);if(0==d.length)break;for(c=0;c<d.length;c++)l[d[c][0]]=i(d[c][1],h,u)}for(c in l)l.hasOwnProperty(c)&&e.isUserObject(l[c])&&(l[c]=r(l[c],h,u));return l},o=function(e,t){var n=[];for(var i in e)if(e.hasOwnProperty(i)&&"string"==typeof e[i]){var r=e[i];r.match(t.getRegex())&&n.push([i,r])}return n},s=function(t,n,i){i.isLayeredDictionary?n.apply(t):e.extend(n,t)},a=function(t,n,i){var r=null;return r=i.isLayeredDictionary?new i.layeredDictionary(n):e.clone(n)};t.interpolate=function(t,n,o){return"undefined"==typeof t||null==t?null:(o=e.cast(u,o),n=n||{},"object"!=typeof n?t:(e.collections&&e.collections.LayeredDictionary&&n instanceof e.collections.LayeredDictionary&&(o.isLayeredDictionary=!0,o.layeredDictionary=e.collections.LayeredDictionary),"string"==typeof t?i(t,n,o):e.isUserObject(t)?r(t,n,o):t))};var u=t.interpolate.InterpolationOptions=function(){this.anchor="$",this.start="{",this.finish="}",this.isLayeredDictionary=!1,this.regex=null,this.getRegex=function(){return this.regex||(this.regex=new RegExp("\\"+this.anchor+"\\"+this.start+"[^\\"+this.finish+"]+\\"+this.finish,"g"))}}})}),define("the-jsonify",["the-object"],function(e){return e(function(t){var n=t.jsonify=function(t,o){var s,a;if("undefined"==typeof t||null==t)return null;if("function"==typeof t)return t.toString();if(o=e.cast(r,o),o.filter&&e.expression&&(o.filter=e.expression(o.filter)),Array.isArray(t)){for(s=[],a=0;a<t.length;a++)s.push(n(t[a],o));return s}if(e.isUserObject(t)){s={};var u=t;if(o.interpolate){if(!e.interpolate)throw"Interpolation requested, but no the-interpolate loaded";u=e.interpolate(t)}for(var a in u)if(u.hasOwnProperty(a)&&(o.privates||"__"!=a.substring(0,2))&&(!o.filter||o.filter(a,u[a],u))){var c=i(a,u[a],u,o);"undefined"!=typeof c&&(s[a]=c)}return s}return"object"==typeof t?t.toString():t},i=n.getValue=function(i,r,o,s){if("undefined"==typeof r)return void 0;if(null===r)return s.nulls&&s.defaults?r:void 0;if(!s.defaults&&t.isDefaultValue(r))return void 0;if("function"==typeof r)return i.match(/^__/)&&!s.privates?void 0:s.evalfunctions?n(r.apply(o,[])):s.functions?s.stringify?r.toString():r:void 0;if(Array.isArray(r))return n(r);if(e.isUserObject(r)){var a=n(r);return s.stringify&&(a=JSON.stringify(a)),a}return"object"==typeof r&&s.stringify?r.toString():r},r=n.JsonifyOptions=function(){this.functions=!0,this.interpolate=!1,this.stringify=!1,this.nulls=!0,this.defaults=!0,this.filter=null,this.evalfunctions=!1,this.privates=!0}})}),define("the-http",["the-object"],function(e){return e(function(t,n){var r=e.object.ExtendOptions.ExtendedCast,o=e.timeout,s=e.tick,a=t.http=function(t){try{var n=a.DetectDefaultTransport(),i=e.cast(l,t,e.object.ExtendOptions.ExtendedCast);i.transport=t.transport;var r=i.transport||n;return r.execute(i)}catch(o){return t.error&&t.error(o),null}},u=n._httpSubscribtions=[];a.addListener=function(e){return u.push(e),a},a.removeListener=function(e){var t=u.indexOf(e);return-1!=t&&u.splice(t,1),a},a.cleanListeners=function(){return u=n._httpSubscribtions=[],this};var c=a.Transport=function(){},l=a.Request=function(){this.url="/",this.params={},this.headers={},this.withCredentials=!0,this.timeout=0,this.username="",this.password="",this.method="GET",this.contentType="application/x-www-form-urlencoded; charset=UTF-8"},h=a.Response=function(t,n){t=e.cast(l,t,r),this.request=t,this.transport=n,this.timeouted=!1,this.complete=!1,this.success=!1,this.isError=!1,this.error=null,this.result=null};h.prototype.notify=function(e){var t=this,n=e;"success"==n?t.request.success&&s(function(){t.request.success(t.result,t)}):("error"==n||"timeout"==n)&&t.request.error&&s(function(){t.request.error(t.error,t)});for(var r=0;r<u.length;i++)s(function(e){u[e](n,t)}.bind(this,[r]))},h.prototype.execute=function(){var e=this;this.request.timeout&&o(function(){e.isError||(e.timeouted=!0,e.isError=!0,e.error="timeout",e.notify("timeout"))},this.request.timeout);try{this.notify("begin"),this.transport.callData(this.request,function(t,n){e.timeouted||(e.complete=!0,e.success=!0,e.nativeResult=n,e.result=t,e.notify("success"))},function(t,n){e.timeouted||(e.complete=!0,e.nativeResult=n,e.isError=!0,e.error=t,e.notify("error"))})}catch(t){e.isError=!0,e.error=t,e.complete=!0,e.notify("error")}return this},c.prototype.execute=function(e){var t=new h(e,this);return t.execute()},c.prototype.callData=function(){throw"abstract, not implemented"};var f=a.JQueryTransport=function(){c.call(this)};f.prototype=Object.create(c.prototype),f.prototype.callData=function(t,n,i){e.checkEnvironment();var r={};return r.url=t.url,r.contentType=t.contentType||"application/x-www-form-urlencoded; charset=UTF-8",r.data=t.params||{},r.headers=t.headers||{},r.ifModified=!0,r.password=t.password||"",r.timeout=t.timeout||0,r.type=t.method||"GET",r.username=t.username||"",r.xhrFields=t.extensions||{},r.xhrFields.withCredentials=!!t.withCredentials||!1,r.error=function(e,t,n){i(n,e)},r.success=function(e,t,i){n(e,i)},e.$jQuery.ajax(r)};var d=a.AngularTransport=function(){c.call(this)};d.prototype=Object.create(c.prototype),d.prototype.callData=function(t,n,i){e.checkEnvironment();var r={};return r.url=t.url,r.method=t.method||"GET","POST"==t.method?r.data=t.parameters||{}:r.params=t.parameters||{},r.headers=t.headers||{},r.withCredentials=!!t.withCredentials||!1,e.$angular.$__http(r).success(function(e,t,i,r){n(e,{status:t,headers:i,config:r})}).error(function(e,t,n,r){i(e,{status:t,headers:n,config:r})})};var p=a.XHRTransport=function(){c.call(this)};p.prototype=Object.create(c.prototype),p.prototype.callData=function(e,t,n){n({erorr:"not implemented"})},a.DefaultTransport=null,a.DetectDefaultTransport=function(){return e.checkEnvironment(),null!=a.DefaultTransport?a.DefaultTransport:a.DefaultTransport=e.$jQuery?new f:e.$angular?new d:new p}})}),define("the-expression",["the-object"],function($the){return $the(function(root){var eOptions=function(){this.type="check",this.annotate=!1,this.and=!1,this.or=!1,this.counter=!1};eOptions.__parse__=function(e){this.type=e};var e=function(t,n){if("undefined"==typeof t||null==t)return null;if(n=$the.cast(eOptions,n),"function"==typeof t)return t.annotation={},n&&n.annotate&&e.annotateFunction(t),t;if(!e.prototypes.hasOwnProperty(n.type))throw"type not registered "+n.type;n.hasOwnProperty("hasExpressionSymbols")||(n.hasExpressionSymbols=!1,"string"==typeof t&&(n.hasExpressionSymbols=!!t.match(/[\.=\-+<>&|*\/!()]/)));var i=e.prototypes[n.type](t,n);return i.annotation={},i};e.nullFunction=function(){return void 0},e.annotateFunction=function(e){e.annotation=e.annotation||{},e.toString().match(/^function\s*\(a\s*,\s*b\s*\)/)&&(e.annotation.comparer=!0)},e.prototypes={},e.prototypes.check=function(expr,options){var result=null;if("number"==typeof expr||"string"==typeof expr&&!options.hasExpressionSymbols)if(options.counter){var current=expr;result=function(){return 0==current?!1:(current--,!0)}}else result=function(e){return e==expr};else if("string"==typeof expr){var realExpr=expr;expr.match(/_/)||(realExpr="_"+realExpr),realExpr="_=function(_,idx){try{return  ("+realExpr+");}catch(e){return false;}}",result=eval(realExpr)}else result=expr instanceof RegExp?function(e){return!!e.match(expr)}:Array.isArray(expr)?options.and?function(t){for(var n=!0,i=0;i<expr.length;i++)if(!e(expr[i])(t)){n=!1;break}return n}:function(t){for(var n=0;n<expr.length;n++)if(e(expr[n])(t))return!0;return!1}:options.or?function(t){for(var n in expr)if(expr.hasOwnProperty(n)){var i=e(expr[n]);if("$"==n[0]){if(i(t))return!0}else if(t.hasOwnProperty(n)&&i(t[n]))return!0}return!1}:function(t){var n=!0;for(var i in expr)if(expr.hasOwnProperty(i)){var r=e(expr[i]);if("$"==i[0]){if(!r(t)){n=!1;break}}else{if(!t.hasOwnProperty(i)){n=!1;break}if(!r(t[i])){n=!1;break}}}return n};return result.expressionType="equal",result},root.expression=e,root.expression.ExpressionOptions=eOptions,root.expression.define=function(t,n){e.prototypes[t]=n}})}),define("the-collections-core",["the-object"],function(e){return e(function(t,n){var i={},r={},o=n._collectionEx=function(t,n){return e.expression?e.expression(t,n):"undefined"==typeof t||null==t?function(){return!0}:"function"==typeof t?t:function(e){return e===t}},s=function(e,t,n){if(this.current=r,this.onNext=t,this._index=-1,this.index=-1,this._wasSetup=!1,n&&(n.referencedEnum&&(this._referencedEnum=u(n.referencedEnum)),n.buffered&&(this._buffered=!0),n.onBuffer&&(this.onBuffer=n.onBuffer.bind(this)),n.onReset&&(this.onReset=n.onReset.bind(this))),e)if(e instanceof s)this._baseEnumeration=e;else if(Array.isArray(e)||"string"==typeof e)this._array=e;else if("number"==typeof e)this._number=e;else{this._object=e,this._nameindex=[];for(var i in this._object)this._object.hasOwnProperty(i)&&this._nameindex.push(i)}};s.prototype.toArray=function(e){this.reset();for(var t=[],n=o(e);this.next(n);)t.push(this.current);return t};var a=function(e,t){this.key=e,this.value=t};s.prototype.next=function(e){if(this._wasSetup||(this._wasSetup=!0,this.onSetup&&this.onSetup()),e=o(e),this.current===i)return!1;this.current===r&&this._buffered&&(this._loadBuffer(),this.onBuffer&&this.onBuffer(this)),this.onBeforeNext&&this.onBeforeNext();for(var t=null;;){t=this.onNext?this.onNext(this,i):this.baseNext(),this.currentItem=t;var n=t;if(this.onGetValue&&(n=this.onGetValue(n)),this.current=n,this.index++,t===i)break;if(!e){this.onFetch&&this.onFetch(this.current,this.index,this);break}if(e(this.current,this.index)){this.onFetch&&this.onFetch(this.current,this.index,this);break}}return t!==i},s.prototype.each=function(e){for(this.reset();this.next();){var t=e(this.current,this.index,this.currentItem);if(t===!1)break}},s.prototype.baseNext=function(){if(this.current===i)return i;if(this._baseEnumeration)return this._baseEnumeration.next()?this._baseEnumeration.current:i;if(this._array)return this._index++,this._index>=this._array.length?i:this._array[this._index];if(this._object){if(this._index++,this._index>=this._nameindex.length)return i;var e=this._nameindex[this._index];return new a(e,this._object[e])}return this._number?(this._index++,this._index>=this._number?i:this._index):i},s.prototype.reset=function(){return this._index=-1,this.index=-1,this.current=r,this.currentItem=void 0,this._baseEnumeration&&this._baseEnumeration.reset(),this._referencedEnum&&this._referencedEnum.reset(),this._buffered&&(this._buffer=null,this._refbuffer=null,this._bufferIter=null,this._refbufferIter=null),this.onReset&&this.onReset(),this},s.prototype._loadBuffer=function(){this._buffer=this._baseEnumeration.toArray(),this._bufferIter=u(this._buffer),this._referencedEnum&&(this._refbuffer=this._referencedEnum.toArray(),this._refbufferIter=u(this._refbuffer))};var u=function(e){return e instanceof s?e:new s(e)};if(u.Enumeration=s,u.KeyValuePair=a,u.EndOfEnumeration=i,u.StartOfEnumeration=r,u.remove=function(e,t){var n=e.indexOf(t);-1!=n&&e.splice(n,1)},u.removeClone=function(e,t){var n=[];return e.forEach(function(e){e!==t&&n.push(e)}),n},t.collections){var c=t.collections;for(var l in c)c.hasOwnProperty(l)&&(u[l]=c[l])}t.collections=u,t.$c=u})}),define("the-collections-layered",["the-collections-core"],function(e){return e(function(e){var t=e.object.cast,n=function(e,t,i){null==e&&(e=0),null==t&&(t=1<<30),null==i&&(i=0),this.mindepth=Math.max(Number(e),0)||0,this.maxdepth=Math.max(Number(t),0)||0,this.skip=Math.max(Number(i),0)||0,this.maxdepth=Math.max(e,t),this.next=function(e){return new n(this.mindepth-1,this.maxdepth-1,e?this.skip-1:this.skip)}},i=function(){if("undefined"==typeof this||!(this instanceof i))return i.build.apply(null,arguments);this.internalIndex={};for(var e=0;e<arguments.length;e++)this.apply(arguments[e]);return this.reset&&this.reset(),this};e.collections=e.collections||{},e.collections.LayeredDictionary=i,e.collections.LayeredDictionaryContext=n,i.prototype=Object.create(e.collections.Enumeration.prototype),i.prototype.reset=function(){e.collections.Enumeration.prototype.reset.call(this),this.keys=this.getKeys()},i.prototype.baseNext=function(){if(this._index++,this._index<this.keys.length){var t=this.keys[this._index];return new e.collections.KeyValuePair(t,this.get(t))}return e.collections.EndOfEnumeration},i.prototype.parent=null,i.prototype.internalIndex=null,i.prototype.apply=function(e){if(e instanceof i)this.parent&&(e.parent=this.parent),this.parent=e;else if("function"==typeof e)e(this);else{if("object"!=typeof e||e instanceof Array||e instanceof RegExp)throw"invalid object to apply";for(var t in e)e.hasOwnProperty(t)&&this.set(t,e[t])}return this.reset&&this.reset(),this},i.prototype.set=function(e,t){if("string"!=typeof e||!e)throw"name must be not empty";return"undefined"!=typeof t?this.internalIndex[e]=t:delete this.internalIndex[e],this.reset&&this.reset(),this};var r=function(e){return e},o=function(e){return!("undefined"==typeof e)};i.prototype.select=function(e,i,o){if(i=i||r,"string"!=typeof e||!e)throw"name must be not empty";if(o=t(n,o),o.mindepth>0)return null==this.parent?i(void 0):this.parent.select(e,i,o.next(!1));if(this.internalIndex.hasOwnProperty(e)){var s=this.internalIndex[e];if(0!=o.skip){var a=null;this.parent&&(a=this.parent.select(e,i,o.next(!0))),null!=a&&(s=a)}return i(s)}return 0==o.maxdepth?i(void 0):null==this.parent?i(void 0):this.parent.select(e,i,o.next(!1))},i.prototype.exists=function(e,t){return this.select(e,o,t)},i.prototype.get=function(e,t){return this.select(e,r,t)},i.prototype.visit=function(e,i,r){if(i=t(n,i),r=r||{},i.mindepth>0)return this.parent?this.parent.visit(e,i.next(!1),r):r;for(var o in this.internalIndex)this.internalIndex.hasOwnProperty(o)&&!r.hasOwnProperty(o)&&(r[o]=!0,e&&e(this.internalIndex[o],o,this));return i.maxdepth>0&&this.parent&&this.parent.visit(e,i.next(!1),r),r},i.prototype.getKeys=function(e){var t=[];return this.visit(function(e,n){t.push(n)},e),t},i.prototype.toObject=function(e){var t={};return this.visit(function(e,n){t[n]=e},e),t},i.build=function(){for(var e=new i,t=0;t<arguments.length;t++){var n=arguments[t];n instanceof i?(n.parent=e,e=n):(n=new i(n),n.parent=e,e=n)}return e}})}),define("the-collections-linked",["the-collections-core"],function(e){return e(function(t,n){var i=t.collections,r=n._collectionEx,o=(e.cast,function(e){this.value=e,this.previous=null,this.next=null,this.key=null});Object.defineProperty(o.prototype,"index",{writeable:!1,get:function(){return this.previous?this.previous.index+1:0}});var s=function(){this.replace=null,this.remove=null},a=function(t,n){if(this.first=null,this.last=null,this.replaceOnMerge=!1,this.removeOnMerge=!1,n&&(e.extend(this,n),n.onKey&&(this.onKey=r(n.onKey).bind(this))),t)for(t=i(t);t.next();)this.append(t.current)};a.prototype=Object.create(i.Enumeration.prototype),a.prototype.merge=function(t,n){n=e.cast(s,n);var r={removed:[],created:[],updated:[]},o=this,a=null==n.remove?this.removeOnMerge:n.remove,u=null==n.replace?this.replaceOnMerge:n.replace,c={};if(i(t).each(function(e){c[o.getKey(e)]=e}),a){var l=[];this.eachItem(function(e){var t=o.getKey(e.value);c.hasOwnProperty(t)||l.push(e)}),l.forEach(function(e){r.removed.push(e.value),o.remove(e)})}var h={};return this.each(function(e){h[o.getKey(e)]=e}),i(t).each(function(e){var t=o.getKey(e);h.hasOwnProperty(t)?u&&(r.updated.push(e),o.replace(e,t)):(r.created.push(e),this.push?o.push(e):o.append(e))}),r},a.prototype.trigger=function(e,t,n){this.onItemTrigger&&this.onItemTrigger(e,t||null,n||null)},a.prototype.onGetValue=function(e){return e instanceof o?e.value:e},a.prototype.baseNext=function(){return i.StartOfEnumeration===this.current?this.first?this.first:i.EndOfEnumeration:this.currentItem?this.currentItem.next?this.currentItem.next:i.EndOfEnumeration:this.first},a.prototype.find=function(e){e=r(e);for(var t=this.first;t;){if("function"==typeof e){if(e(t.key))return t;if(e(t.value))return t;if(e(t))return t}if(e==t.key)return t;if(e==t.value)return t;t=t.next}return null},a.prototype.itemByIndex=function(e){if(0>e)return void 0;var t=this.first||void 0;if(0==e)return t;for(var n=0;e>n;n++){if(!t.next)return void 0;t=t.next}return t},a.prototype.byIndex=function(e){var t=this.itemByIndex(e);return"undefined"==typeof t?void 0:t.value},Object.defineProperty(a.prototype,"currentIndex",{get:function(){return this.currentItem?this.currentItem.index:-1},set:function(e){this.gotoIndex(e)}}),a.prototype.indexOf=function(e){var t=this.__resolveTarget(e);return t?t.index:-1},a.prototype.gotoIndex=function(e,t){var n=this.itemByIndex(e);if(null!=n){var i;if(t>0)for(i=0;t>i;i++){if(!n.next){n=void 0;break}n=n.next}else if(0>t)for(i=0;i>t;i--){if(!n.previous){n=void 0;break}n=n.previous}void 0===n?this.reset():(this.currentItem=n,this.current=n.value,this._index=n.index)}},a.prototype["goto"]=function(e,t){var n=this.find(e);if(null!=n){var i;if(t>0)for(i=0;t>i;i++){if(!n.next){n=void 0;break}n=n.next}else if(0>t)for(i=0;i>t;i--){if(!n.previous){n=void 0;break}n=n.previous}void 0===n?this.reset():(this.currentItem=n,this.current=n.value,this._index=n.index)}},a.prototype.each=function(e){for(var t=this.first;t;)e(t.value),t=t.next},a.prototype.eachItem=function(e){for(var t=this.first;t;)e(t),t=t.next},a.prototype.append=function(e){return e=this.setupItem(e),e.previous=this.last,this.last&&(this.last.next=e),this.last=e,this.first||(this.first=e),this.trigger("insert",e),this},a.prototype.getKey=function(e){return this.onKey?this.onKey(e):e},a.prototype.setupItem=function(e){return e instanceof o||(e=new o(e)),this.onKey&&(e.key=this.onKey(e.value)),e},a.prototype.prepend=function(e){return e=this.setupItem(e),e.next=this.first,this.first&&(this.first.previous=e),this.first=e,this.last||(this.last=e),this.trigger("insert",e),this},a.prototype.insertBefore=function(e,t){var n=this.__resolveTarget(t);if(!n)throw"cannot find target for insert";return e=this.setupItem(e),e.next=n,e.previous=n.previous,n.previous&&(n.previous.next=e),n.previous=e,this.first==n&&(this.first=e),this.trigger("insert",e),this},a.prototype.insertAfter=function(e,t){var n=this.__resolveTarget(t);if(!n)throw"cannot find target for insert";return e=this.setupItem(e),e.previous=n,e.next=n.next,n.next&&(n.next.previous=e),n.next=e,this.last==n&&(this.last=e),this.trigger("insert",e),this},a.prototype.replace=function(e,t){var n=this.__resolveTarget(t);if(!n)throw"cannot getByKey target for insert";return e=this.setupItem(e),e.previous=n.previous,e.next=n.next,e.previous&&(e.previous.next=e),e.next&&(e.next.previous=e),this.first==n&&(this.first=e),this.last==n&&(this.last=e),this.trigger("update",e,n),this},a.prototype.__resolveTarget=function(e){return e?e instanceof o?e:this.find(e):this.currentItem||this.first},a.prototype.remove=function(e){var t=this.__resolveTarget(e);if(!t)throw"cannot getByKey target for insert";return t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous),this.first==t&&(this.first=t.next),this.last==t&&(this.last=t.previous,this.last||(this.last=this.first)),this.currentItem===t&&(this.currentItem=t.next|t.previous|this.first,this.current=this.currentItem.value),this.trigger("delete",null,t),this};var u=function(e,t){a.call(this,e,t)};u.prototype=Object.create(a.prototype),u.prototype.pop=function(){return this.next()?this.current:(this.reset(),this.next(),this.current)},u.prototype.push=function(e){this.insertAfter(e)},u.prototype["goto"]=function(e,t){var n=this.find(e);if(null!=n){var i;if(t>0)for(i=0;t>i;i++)n=n.next?n.next:this.first;else if(0>t)for(i=0;i>t;i--)n=n.previous?n.previous:this.last;this.currentItem=n,this.current=n.value,this._index=n.index}};var c=function(e,t){if(a.call(this,null,t),e){var n=this;i(e).each(function(e){n.push(e)})}};c.prototype=Object.create(a.prototype),c.prototype.push=function(e){this.prepend(e)},c.prototype.pop=function(){if(null==this.first)return null;var e=this.first.value;return this.remove(this.first),this.reset(),e};var l=function(e,t){a.call(this,e,t)};l.prototype=Object.create(a.prototype),l.prototype.push=function(e){this.append(e)},l.prototype.pop=c.prototype.pop,i.Enumeration.prototype.toList=function(){return new a(this)},i.Enumeration.prototype.toStack=function(){return new c(this)},i.Enumeration.prototype.toQueue=function(){return new l(this)},i.Enumeration.prototype.toCycle=function(){return new u(this)},i.LinkedList=a,i.LinkedItem=o,i.CycleList=u,i.Stack=c,i.Queue=l})}),define("the-collections-history",["the-collections-core"],function(e){return e(function(t){var n=t.object.digest,i="undefined"==typeof localStorage?e.localStorage:localStorage,r=function(){this.size=20,this.lskey="",this.fixedOrder=!0,this.jsonify=!0,this.jsonifyOptions={}},o=function(t){if(this.options=e.cast(r,t),this.items=[],this.index={},this.version=0,this.options.lskey){var n=i.getItem(this.options.lskey);if(n){n=JSON.parse(n);for(var o=n.length-1;o>=0;o--)n[o]&&this.add(n[o].item,!0)}}};t.collections=t.collections||{},t.collections.History=o,t.collections.HistoryOptions=r,o.prototype=Object.create(t.collections.Enumeration.prototype),o.prototype.baseNext=function(){return this._index++,this._index<this.items.length?this.items[this._index].item:t.collections.EndOfEnumeration},o.prototype.getItems=function(){var e=[];return this.items.forEach(function(t){e.push(t.item)}),e},o.prototype.add=function(t,r){if(null!=t){this.options.fixedOrder&&(t=e.object.fixedOrder(t)),this.options.jsonify&&(t=e.jsonify(t,this.options.jsonifyOptions));var o=n(t),s=this.index[o];if(!s)if(s=this.index[o]={item:t},this.items.length==this.options.size){var a=this.items[this.options.size-1],o=n(a.item);delete this.index[o],this.items[this.options.size-1]=s}else this.items.push(s);s.version=this.version++,this.items.sort(function(e,t){return e.version>t.version?-1:e.version<t.version?1:0}),this.options.lskey&&!r&&i.setItem(this.options.lskey,JSON.stringify(this.items))}},o.prototype.clear=function(){this.index={},this.items=[],this.reset()}})}),define("the-collections-linq",["the-collections-core","the-expression"],function(e){return e(function(t,n){var i=e.collections.Enumeration,r=n._collectionEx,o=e.collections;i.prototype.any=function(e){return this.reset().next(r(e))},i.prototype.indexOf=function(e,t){this.reset(),t=t||0;for(var n=r(e);this.next(n);)if(this._index>=t)return this._index;return-1},i.prototype.count=function(e){this.reset();for(var t=0,n=r(e);this.next(n);)t++;return t},i.prototype.sum=function(e){this.reset();for(var t=0,n=r(e);this.next();)t+=n?n(this.current):this.current;return t},i.prototype.first=function(e){if(this.reset(),e=r(e),this.next(e))return this.current;throw"first element for this conditions not found"},i.prototype.firstOrDefault=function(e,t){return this.reset(),e=r(e),this.next(e)?this.current:t},i.prototype.where=function(e){return this.reset(),e=r(e),new i(this,function(t){return t._baseEnumeration.next(e),t._baseEnumeration.current})},i.prototype.union=function(e){return e=o(e),this.reset(),e.reset(),new i(this,function(t,n){return t._baseEnumeration.next()?t._baseEnumeration.current:e.next()?e.current:n},{referencedEnum:e})},i.prototype.select=function(e){return e=r(e),new i(this,function(t,n){if(t._baseEnumeration.next()){var i=t._baseEnumeration.current;return e&&(i=e(i)),i}return n},null)},i.prototype.distinct=function(e){e=r(e);var t={};return new i(this,function(n,i){for(;n._baseEnumeration.next();){var r=n._baseEnumeration.current,o=r;if(e&&(o=e(r)),!t.hasOwnProperty(o))return t[o]=r,r}return i},{onReset:function(){t={}}})},i.prototype.reverse=function(){return new i(this,function(e,t){var n=this;return-1==n._index?t:n._buffer[n._index--]
},{buffered:!0,onBuffer:function(){var e=this;this._index=e._buffer.length-1}})},i.prototype.order=function(e){var t=r(e,{annotate:!0});if(e&&!t.annotation.comparer){var n=t;t=function(e,t){return n(e)-n(t)}}return new i(this,function(e,t){var n=this;return n._bufferIter.next()?n._bufferIter.current:t},{buffered:!0,onBuffer:function(){var e=this;t?e._buffer.sort(t):e._buffer.sort()}})},i.prototype.except=function(e,t){return e=o(e),t=r(t),new i(this,function(e,n){for(;e._bufferIter.next();)if(t){if(!function(n){return e._refbufferIter.any(function(e){return t(e)==n})}(t(e._bufferIter.current)))return e._bufferIter.current}else{var i=e._refbufferIter.any(function(t){return t==e._bufferIter.current});if(!i)return e._bufferIter.current}return n},{buffered:!0,referencedEnum:e})},i.prototype.skip=function(e){var t=r(e,{counter:!0}),n=!1;return new i(this,function(e,i){for(var r=this;!n;){var o=r._baseEnumeration.next();if(!o)return i;if(!t(r._baseEnumeration.current))return n=!0,r._baseEnumeration.current}return r._baseEnumeration.next()?r._baseEnumeration.current:i},{onReset:function(){t=r(e,{counter:!0}),n=!1}})},i.prototype.take=function(e){var t=r(e,{counter:!0});return new i(this,function(e,n){var i=this,r=i._baseEnumeration.next();return r&&t(i._baseEnumeration.current)?i._baseEnumeration.current:n},{onReset:function(){t=r(e,{counter:!0})}})}})}),define("the-hash",["the-object"],function(e){return e(function(e){var t=e.hash=e.hash||{};t.get=function(e,t,n){"undefined"==typeof t&&(n=!0,t=document.location.hash),t=t||document.location.search||"",n&&(e=encodeURIComponent(e));var i=e.replace(/\./g,"\\.");n&&(i=i.replace(/%20/g,"(\\+|%20)"));var r=new RegExp("[/&\\#\\?]"+i+"=([^&]*)","i"),o=t.match(r);if(o){var s=o[o.length-1];return n?decodeURIComponent(s.replace(/\+/g," ")):s}return""},t.setFlag=function(e,t,n,i){return t=t?1:null,this.set(e,t,n,i)},t.set=function(e,t,n,i){var r=!1;"undefined"==typeof n&&(n=document.location.hash,i=!0,r=!0);var o=null==t||"undefined"==typeof t;e=e||"__value",n=n||"",t=t||"",i&&(t=encodeURIComponent(t),e=encodeURIComponent(e)),t=o?"":"&"+e+"="+t;var s=e.replace(/\./g,"\\.");i&&(s=s.replace(/%20/g,"(\\+|%20)"));var a=new RegExp("&"+s+"=([^&]*)","i");return n.match(a)?n=n.replace(a,t.replace("$","$$")):n+=t,r&&(0==n.length&&(n="#"),"#"!=n[0]&&(n="#"+n),document.location.hash?document.location.href=document.location.href.match(/^([^#]+)/)[0]+n:document.location.href+=n),n}})}),define("the-log",["the-object","the-hash"],function(e){return e(function(e){var t=e.log||(e.log={}),n=t.CodeGeneric="000",i=t.Message||(t.Message=function(e,t,n,i){this.level=t,this.text=e,this.type=n,this.code=i,this.time=new Date,this.url="",void 0!=typeof document&&(this.url=document.location.href),this.visible=!0});i.prototype.hide=function(){this.visible=!1,console.debug(t.activemessages);var e=t.activemessages.indexOf(this);t.activemessages.splice(e,1)},i.prototype.remove=function(){var e=t.messages.indexOf(this);e>=0&&t.messages.splice(e,1)},t.messages=t.messages||(t.messages=[]),t.activemessages=t.activemessages||(t.activemessages=[]),t.add=function(r,o,s,a){var u=null;if(r instanceof i)t.messages.unshift(r),u=r;else{o=o||"info",s=s||"generic",a=a||o[0].toUpperCase()+s[0].toUpperCase()+n;var u=new i(r,o,s,a);t.messages.unshift(u)}return u.visible&&t.activemessages.unshift(u),e.$angular&&e.$rootScope&&(e.$rootScope.$broadcast("THELOG",u),e.$rootScope.$$phase||e.$rootScope.$apply()),u},t.clear=function(){this.messages=[]},t.error=function(e,n,i){t.add(e,"error",n,i)},t.warn=function(e,n,i){t.add(e,"warn",n,i)},t.hideAll=function(){t.messages.forEach(function(e){e.hide()})},t.copyToClipboard=function(){clipboardData}})}),define("the-action",["the-jsonify","the-http","the-log"],function(e){return e(function(t,n){var i=e.cast,r=e.extend,o=e.object.ExtendOptions.ExtendedCast,s=e.jsonify,a=e.http,u=e.timeout,c=function(){this.success=null,this.error=null,this.transport=null,this.emitter=null,this.headers=null,this.extensions=null,this.method="",this.withCredentials=null,this.suppressDefault=!1,this.eventName="",this.castresult=null,this.rawResult=!1,this.parameters={},this.delay=0,this.targetWindow=""},l=function(){return this instanceof l?(this.baseUrl="/",this.addressType="url",this.method="GET",this.arguments=null,this.result=null,this.castresult=!0,this.headers=null,this.extensions=null,this.useparams=!0,this.withCredentials=!0,this.success=null,this.error=null,this.eventName="",this.jsonify=!0,this.delay=0,this.appPath="",this.targetWindow="",this.evalFunctions=!1,this.jsonifyOptions={interpolate:!1,defaults:!1,stringify:!0,evalfunctions:this.evalFunctions,functions:!1,privates:!1},this.__callMoniker=null,this):f.apply(null,arguments)};l.prototype.execute=function(){var e=this.normalizeParameters(arguments),n=Math.max(this.delay,e.callinfo.delay),i=this.createRequest(e.args,e.callinfo);if(!i.popup){var r=this;if(clearTimeout(r.__callMoniker),0!==n){{r.__callMoniker}return r.__callMoniker=u(function(){a(i)},n),null}return a(i)}var o=i.url;t.isDefaultValue(i.params)||(o+=o.match(/\?/)?"&":"?",o+=$.param(i.params)),window.open(o,i.targetWindow)},l.prototype.getUrl=function(t,n){n=i(c,n||{},o);var r=n.baseUrl||this.baseUrl||"/",s=n.addressType||this.addressType||"url";if("url"===s){var a=n.url||this.url||"";t&&-1!=a.indexOf("$")&&(e.interpolate?a=e.interpolate(a,t):console.warn("can lost interpolable urls while interpolation module not loaded")),a=a||"",a=a.replace(/HOSTNAME/,document.location.hostname),a.match(/^http/)||(a="/"+r+"/"+a);var u=n.appPath||this.appPath||"";return u&&(document&&(u=e.interpolate(u,document.location)),a=u+"/"+a),a=a.replace(/\/+/g,"/").replace(/^(https?):\//,"$1://")}throw"special urls are not supported for now"},l.prototype.normalizeParameters=function(e){for(var t=null,n=null,r=null,s=null,a=0;a<e.length;a++){var u=e[a];"function"==typeof u?r?s=u:r=u:t||u instanceof c?n=u:t=u}t=t||{},n=i(c,n||{},o),r&&!s&&(s=function(e,t){r(null,t,e)}),n.success=r||n.success||t.success,n.error=s||n.error||t.success;var l={args:t,callinfo:n};return l},l.prototype.prepareEmitter=function(){if(this.emitter&&this.eventName){var e=this,t=this.emitter.on||this.emitter.$on;t.call(this.emitter,"CALL:"+this.eventName,function(t,n){e.execute.apply(e,n)})}};var h=function(e){return!e.match(d)};l.prototype.createRequest=function(n,a){n=n||{},a=i(c,a||{},o);var u=this.getUrl(n,a),l={url:u,params:{},headers:{},extensions:{}};if(this.useparams&&(l.params=this.arguments?new this.arguments:{},r(l.params,this.parameters,{filter:h}),r(l.params,a.parameters,{filter:h}),r(l.params,n||{},{filter:h,ignoreCase:!0}),this.jsonify)){var f=this.jsonifyOptions;!e.interpolate&&f.interpolate&&(console.warn("may be lost interpolation while interpolation module not loaded"),f=e.clone(f),f.interpolate=!1),l.params=s(l.params,f)}var d=a.targetWindow||this.targetWindow;if(d&&(l.popup=!0,l.targetWindow=d),l.popup)l.method="GET";else{l.method=a.method||this.method,g(l,this),r(l.headers,this.headers),r(l.headers,a.headers),r(l.extensions,this.extensions),r(l.extensions,a.extensions),g(l,n);var p=this,m=a.eventName||this.eventName;"disable"===m&&(m=null);var v=a.emits||this.emits;"disable"===v&&(v=null);var y=a.emitter||this.emitter,b=a.result||this.result,_=(a.castresult||this.castresult)&&!!b&&!a.rawResult,x=y?y.emit||y.$broadcast:null,w=function(e,t){var n=e;if(_)if(Array.isArray(e)){n=[];for(var r=0;r<e.length;r++)n.push(i(b,e[r],o))}else"object"==typeof e&&(n=i(b,e,o));a.success&&a.success(n,t),p.success&&!a.suppressDefault&&p.success(n,t),m&&y&&!a.suppressDefault&&x.call(y,m,[n,t,p]),v&&y&&v.forEach(function(e){x.call(y,e,[n,t,p])})},$=function(e,n){var i=new t.log.Message(e,"error","ajax","EA001");i.action=p,i.request=l,i.response=n,t.log.add(i),a.error&&a.error(e,n),p.error&&!a.suppressDefault&&p.error(e,n),m&&y&&!a.suppressDefault&&x.call(y,"ERROR:"+m,[e,n,this]),v&&y&&v.forEach(function(t){x.call(y,"ERROR:"+t,[e,n,p])})};l.success=w,l.error=$;var k=this.withCredentials;null!=a.withCredentials&&(k=a.withCredentials),k&&(l.withCredentials=k),e.isDefaultValue(l.headers)&&delete l.headers,e.isDefaultValue(l.extensions)&&delete l.extensions}return l};var f=t.action=l.build=function(e,t,n,r){e=e||{};var s=e.transport||null,a=e.emitter||null;delete e.transport,delete e.emitter,e=i(l,e||{},o),e.transport=t||s,e.emitter=n||a,e.baseUrl=r||e.baseUrl;var u=function(){return e.execute.apply(e,arguments)};return u.action=e,u.createRequest=e.createRequest.bind(e),u.getUrl=e.getUrl.bind(e),u.__callMoniker=0,e.prepareEmitter(),u},d=/h[qd]_/,p=n.stubtransport={},m=n.stubemitter={};l.prototype.transport=p,l.prototype.emitter=m;var g=n.applyHttpExtensions=function(e,t){for(var n in t)if(t.hasOwnProperty(n)&&n.match(d)){var i=t[n],o=n.substring(1,2),s=n.substring(3);"q"==o?"object"==typeof i?(e.extensions[s]=e.extensions[s]||{},r(e.extensions[s],i)):e.extensions[s]=i:"d"==o&&(e.headers=e.headers||{},e.headers[s]=i)}return e};t.action.Action=l})}),define("the-angular",["the-root"],function(e){return e(function(t){t.checkEnvironment(),t.$angular?(t.$angular.directiveCall=function(e,t,n,i,r){var o=t[n]||i;if(o.match(/\(/))e.$eval(o,r);else{var s=e.$eval(o);if(s){var a=[];for(var u in r)a.push(r[u]);s.apply(null,a)}}},t.modules=t.modules||{},t.modules.all=t.$angular.module("the-all",[]).run(["$rootScope","dropdownService",function(n,i){t.$rootScope=n,e.uiversion=n.$uiVersion=$("html").attr("ui-version")||"0.1";var r=$("meta[name=uiversion]");0!=r.length&&(e.uiversion=n.$uiVersion=r.attr("value")),n.moment=function(){return window.moment.apply(null,arguments)},n.uistate=t.uistate,n.dropdown=i,n.log=t.log,n.$getView=function(e){return e.match(/^http/)?e:(e.match(/^\/?views\//)||(e="views/"+e),e.match(/\.html/)||(e+=".html"),e.match(/\?/)||(e=e+"?ui-version="+n.$uiVersion),e)},n.$tryApply=function(e,t){e=e||n,null==t&&(t=e,e=n),e.$$phase?t():e.$apply(t)}}])):console.error("angular not loaded")})}),define("the-login",["the-angular","the-action"],function(e){return e(function(t){if(null!=t.modules){var n=function(e,t,n){this.result=e||!1,this.error=t||"",this.redirect=n||""},i=function(e,t,n,i){this.login=e,this.pass=t,this.resource=n||"",this.redirect=i||""},r=new e.action({url:"/logon",result:n,arguments:i}),o=new e.action({url:"/logout"}),s=new e.action({url:"/isauth"}),a=new e.action({url:"/myinfo"}),u=new e.action({url:"/resetpwdreq"}),c=new e.action({url:"/resetpwd"}),l=new e.action({url:"/info/app"}),h=e.login||(e.login={}),f=h.actions||(h.actions={});f.login=r,f.logout=o,f.isauth=s,f.appinfo=l,f.myinfo=a,f.requestkey=u,f.resetpass=c,h.isauth=function(e){h.actions.isauth({success:function(t){e&&e(t)},error:function(t){e&&e(!1,t)}})},h.requestkey=function(e,t){h.actions.requestkey(e,{method:"POST",success:function(e){t&&t(e)},error:function(e,n){t&&t(!1,e,n.nativeResult.responseJSON)}})},h.resetpass=function(e,t){h.actions.resetpass(e,{method:"POST",success:function(e){t&&t(e)},error:function(e,n){t&&t(!1,e,n.nativeResult.responseJSON)}})},h.logon=function(e,t){h.actions.login(e,{method:"POST",success:function(e){var i=new n(e===!0,e===!0?"":e);t&&t(i)},error:function(e){t&&t(new n(!1,e))}})},h.logout=function(e){h.actions.logout({success:function(t){e&&e(t)},error:function(t){e&&e(!1,t)}})},h.appinfo=function(e){h.actions.appinfo({success:function(t){e&&e(t)},error:function(t){e&&e(!1,t)}})},h.myinfo=function(e){h.actions.myinfo({success:function(t){e&&e(t)},error:function(t){e&&e(!1,t)}})}}})}),define("the-angular-unsafe",["the-angular"],function(e){return e(function(e){if(null!=e.modules){var t=["$sce",function(e){return function(t){return e.trustAsHtml(t)}}];e.modules.f_unsafe=e.$angular.module("the-unsafe",[]).filter("unsafe",t),e.modules.all.filter("unsafe",t);var n=[function(){return function(e){return e?e.match(/\/>/)?e:e="<p>"+e.replace(/\s*[\r\n]+\s*/g,"</p><p>")+"</p>":""}}];e.modules.all.filter("simplehtml",n)}})}),define("autocomplete-html",[],function(){return'<input class="dropdown-toggle form-control " ng-focus="__acFocus()" ng-model="${bindQuery}" ng-change="__acChange(1)"    on-enter="__acChange(2)"/> <ul  ng-if="!${hasTemplateUrl}" class="dropdown-menu ${ddClass}">     <li class="default"  ng-repeat="i in __fixdata">         <a ng-click="__acClick($event,i)">${template}</a>     </li>     <li ng-if="__fixdata.length!=0 && __data.length!=0" class="delimiter"></li>     <li ng-repeat="i in __data">         <a ng-click="__acClick($event,i)">${template}</a>     </li> </ul><ul ng-if="${hasTemplateUrl}" class="dropdown-menu ${ddClass}" ng-include="${templateUrl}"> </ul>'}),define("the-angular-autocomplete",["the-angular","autocomplete-html"],function(e,t){return e(function(n){if(null!=n.modules){var i=function(n,i){var r=$(n);r.addClass("ac-dropdown"),r.addClass("the-autocomplete"),r.attr("dropdown","dropdown"),r.attr("is-open","__isopen");var o={bindQuery:i.ngModel||"__acSearch",template:i.template||"{{i}}",templateUrl:i.templateUrl||"",ddClass:i.ddClass||"",hasTemplateUrl:!!i.templateUrl};o.templateUrl&&!o.templateUrl.match(/\(/)&&(o.templateUrl="'"+o.templateUrl+"'");var s=e.interpolate(t,o),a=$(s);a.appendTo(r),r.find("ul").css("overflow-y","auto"),i.height&&r.find("ul").css("max-height",""+i.height+"px")},r=function(e,t,n,i){{var r={bindQuery:n.ngModel||"__acSearch",template:n.template||"{{i}}",templateUrl:n.templateUrl||"",ddClass:n.ddClass||""},o="minLength"in n?n.minLength:1,s=null;$(t)[0]}e.__data=[],e.__fixdata=[],e.__acSearch="",e.firstRun=!0;var a=function(e){for(var t=e.target;t;){if(t==c[0])return;t=t.parentNode}u()},u=function(){$(window).off("mousedown",a),$(t).removeClass("open"),c&&c.hide()};i.$on("HIDEMENUES",function(){u()});var c=null,l=function(i){c||(c=$(t).find("ul"),c.appendTo(document.body));var r=e.$eval(n.onShow);if(!r||r(e.__data,i,c,t)){$(window).on("mousedown",a),$(t).addClass("open");var o=$(t).find("input"),s=o[0].getBoundingClientRect(),u=s.bottom,l=s.left;c.css("top",u+"px"),c.css("left",l+"px"),c.show()}};e.__acFocus=function(){if($(t).hasClass("open")||0==e.__data.length&&0==e.__fixdata.length){if(!$(t).hasClass("open")&&e.firstRun)if(e.firstRun=!1,n.emptySearch)e.__acChange(2);else{var i=e.$eval(n.bld);"function"==typeof i&&i(function(t){e.__fixdata=t,l(!0)})}}else l(!0)},e.__onData=function(t){var i=e.$eval(n.onEndSearch);"function"==typeof i&&(t=i(t)||t),e.$apply(function(){e.__data=t}),l()},e.__acChange=function(t){if(!n.onEnterOnly||1!=t){clearTimeout(s),u();var i=e.$eval(r.bindQuery);(""==i&&n.emptySearch||i.length>=o)&&(s=setTimeout(function(){var t=e.$eval(n.onStartSearch);if("function"==typeof t&&e.$apply(function(){i=t(i)||i}),n.onSearch){var r=n.onSearch;r.match(/\(/)||(r+="(search,callback)"),e.$eval(r,{search:i,callback:e.__onData})}},300))}},e.__acClick=function(t,i){if(t.preventDefault(),t.stopPropagation(),u(),n.onResult){var o=e.$eval(r.bindQuery),s=n.onResult;s.match(/\(/)||(s+="(i,search,e)"),e.$eval(s,{search:o,i:i,e:t})}};var h=e.$eval(n.onInit);"function"==typeof h&&h(e,t,n)},o=function(e){return{scope:!0,compile:function(t,n){return i(t,n),{pre:function(t,n,i){r(t,n,i,e)}}}}};n.modules.d_autocomplete=n.$angular.module("the-autocomplete",[]).directive("theAutocomplete",["$rootScope",o]),n.modules.all.directive("theAutocomplete",["$rootScope",o]),n.modules.autoCompleteSet={compile:i,link:r}}})}),define("the-angular-autoselect",["the-angular"],function(e){return e(function(e){null!=e.modules&&e.modules.all.directive("autoselect",function(){return{compile:function(e){$(e[0]).focus(function(){function e(){return t.off("mouseup",e),!1}var t=$(this);t.select(),window.setTimeout(function(){t.select()},1),t.mouseup(e)})}}})})}),define("the-angular-ellipse",["the-angular"],function(e){return e(function(e){if(null!=e.modules){var t=function(e,t){e=e.substring(0,t);var n=e.lastIndexOf(" ");return e.substring(0,n)+"..."},n=function(e,n){var i=$(e),r=i.text();return t(r,n)},i=[function(){return function(e,i){return i=i||100,e.length<=i?e:e.match(/^</)?n(e,i):t(e,i)}}];e.modules.all.filter("ellipse",i)}})}),define("the-angular-reports",["the-angular"],function($the){return $the(function(root,privates){root.modules.all.factory("thereports",["$http","$compile",function($http,$compile){function prepare(target,d,$scope){d.items.forEach(function(_){target.reports.push(_),target.ireports[_._id]=_,_.onform&&(_.onform=eval("___="+_.onform)),_.onquery&&(_.onquery=eval("___="+_.onquery)),_.toolbar=function(){return _.toolview?_.toolview:"views/the/report-toolbar.html"},_.params={if_has_level:function(e,t,n){for(var i=e,r=n||"level";;){if(i--,0==i)return!1;var o=r+i;if(!this.hasOwnProperty(o))return!1;var s=this[o];if(-1!=t.indexOf(s))return!0}return!1},if_no_level:function(e,t,n){for(var i=e,r=n||"level";;){if(i--,0==i)return!0;var o=r+i;if(!this.hasOwnProperty(o))return!0;var s=this[o];if(-1!=t.indexOf(s))return!1}return!0},level_change:function(e,t){for(var n=t||"level",i=e+1;10>=i;i++){var r=n+i;if(!this.hasOwnProperty(r))return;this[r]="none"}},level_visible:function(e,t){if(1==e)return!0;var n=t||"level",i=n+(e-1);return this.hasOwnProperty(i)?"none"!=this[i]:!0}},_.lists={},_.parameters.forEach(function(e){e.show=function(){return e.hidden?!1:e.ngif?$scope.$eval(e.ngif,{report:_,params:_.params}):!0},e.change=function(){return e.ngchange?$scope.$eval(e.ngchange,{report:_,params:_.params}):!0},_.params[e._id]=e["default"],e.list&&e.list.length&&(_.lists[e._id]=e.list,e.list.forEach(function(e){e.show=function(){return e.ngif?$scope.$eval(e.ngif,{report:_,params:_.params}):!0}})),"bool"==e.type&&(_.params[e._id]="true"==e["default"]||e["default"]===!0)})})}return function(e){return{reports:[],ireports:{},loaded:!1,current:null,currentid:-1,get:function(e){var t=this;return e=e||t.current,"object"!=typeof e&&(e=t.ireports[e]),e},render:function(t,n,i){var t=this.get(t);if(t){i=$the.extend({target:null,compile:!0,scope:e,onscope:function(e,t,n){e.report_query=t,e.report_def=n}},i||{});var n=$the.extend({id:t._id,dataonly:null,standalone:null,format:null,findquery:null,flags:null,success:null,parameters:{}},n);n.parameters=$the.extend(t.params,n.parameters),t.onquery&&t.onquery(n,t,e);var r=$http({url:"/report",method:"POST",data:$the.jsonify(n,{nulls:!1,defaults:!1,functions:!1})}).then(function(e){var t=e.data;if("string"==typeof t&&i.target){var r=$(t);if($(i.target).html(""),r.appendTo($(i.target)),i.compile){var o=i.scope?i.scope.$new():$rootScope.$new();i.onscope&&i.onscope(o,n,t),$compile(r)(o)}}n.success&&n.success(t)});return r}},select:function(e){var e=this.get(e);if(e)return this.current!=e&&(this.current=e),e},load:function(){var t=this;if(t.loaded)return $q(function(e){e(t)});t.reports=[{_id:-1,name:" "}],t.ireports={"-1":t.reports[0]};var n=$http.get("/reports/list",{noagents:!0}).then(function(n){return loaded=!0,prepare(t,n.data,e),t});return n}}}}])})}),define("the-angular-datetimepicker",["the-angular"],function(e){return e(function(e){null!=e.modules&&(e.modules.all.directive("datetimepicker",function(){return{link:function(e,t,n){var i=n.ngChange,r=n.ngModel;$(t[0]).datetimepicker({lang:"ru",format:"d.m.Y H:i",step:15,onChangeDateTime:function(t,n){r&&setTimeout(function(){r&&e.$eval(r+"='"+$(n).val()+"'"),i&&e.$eval(i)},4)}})}}}),e.modules.all.directive("datepicker",function(){return{link:function(e,t,n){var i=n.ngChange,r=n.ngModel;t[0].__dtsetup||(t[0].__dtsetup=!0,$(t[0]).datetimepicker({lang:"ru",format:"d.m.Y",timepicker:!1,closeOnDateSelect:!0,scrollInput:!1,onChangeDateTime:function(t,n){r&&setTimeout(function(){r&&e.$eval(r+"='"+$(n).val()+"'"),i&&e.$eval(i)},4)}}))}}}))})}),define("the-angular-validation",["the-angular"],function(e){return e(function(e){if(null!=e.modules){var t=function(){return{require:"ngModel",link:function(e,t,n,i){i.$validators.compareTo=function(t){var i=e.$eval(n.compareTo);return t==i||!t&&!i},e.$watch(function(){return e.$eval(n.compareTo)},function(){i.$validate()})}}},n=function(){return{require:"ngModel",link:function(e,t,n,i){i.$validators.passwordPolicy=function(e){if(!n.ngRequired&&!e)return!0;if(null==e)return!1;if(e.length<8)return!1;for(var t={},i=0,r=0;r<e.length;r++){var o=e[r];o in t||(i++,t[e[r]]=!0)}if(i<e.length-2)return!1;for(var s=!1,a=!1,u=!1,c=!1,l=!1,r=0;r<e.length;r++){var h=e[r];h.match(/\d/)?u=!0:h.toLowerCase()!=h.toUpperCase()?h.toLowerCase()==h?a=!0:s=!0:c=!0}return a&&s&&u&&c&&(l=!0),l?!0:!1}}}};e.modules.all.directive("compareTo",t),e.modules.all.directive("passwordPolicy",n)}})}),define("the-uploader",["the-root","the-angular"],function(e){var t="/accident/upload";return e.uploader={uploadsingle:function(n,i,r,o){var s=5242880,a="5";if(n.type.match(/video/)&&(s=26214400,a="25"),n.size>s)return e.dialog.alert("  -   "+n.name+" "+a,"  "),!1;var u=new FormData;u.append("file",n),$.ajax({url:o||t,data:u,processData:!1,contentType:!1,type:"POST",success:function(e){i&&i(e)},error:function(e,t,n){r&&r(n,t,e)}})},upload:function(e,t,n,i){var r=null,o=$(t);r=$(e||t)[0].files;var s=this,n=n||$(t).prevAll("i")||$(t);n.addClass("button progress primary");var a=-1,u=[],c=[],l=function(){o.replaceWith(o.val("").clone(!0)),i&&i(c),u.forEach(function(e){i&&i(null,e.e,e.s,e.x)})},h=function(){if(a++,a>=r.length)return n.removeClass("button progress primary"),void l();var e=r[a],t=s.uploadsingle(e,function(e){c.push(e),h()},function(t,n,i){console.error(e.name,"upload error",t,i.responseText),u.push({x:i,s:n,e:t}),h()});t===!1&&h()};h()}},null!=e.modules?(e.modules.all.directive("uploader",function(){return{templateUrl:"views/the/uploader.html",scope:!0,link:function(t,n,i){t.__dragenter=function(e){return $(e).addClass("dragging"),!0},t.__dragover=function(){return!1},t.__dragleave=function(e){return $(e).removeClass("dragging"),!1},t.__drop=function(e,n){return $(e).removeClass("dragging"),n.preventDefault(),n.stopPropagation(),t.__uploaddrop(n.dataTransfer,$(e)),!1},t.__uploaddrop=function(n,r){i.onfiles&&t.$eval(i.onfiles,{$files:n.files}),i.noupload||e.uploader.upload(n,null,r,function(n,r,o,s){n?t.$tryApply(function(){i.onupload&&t.$eval(i.onupload,{$result:n})}):(console.error("upload error",r,o,s.responseText),i.onuploaderror?t.$tryApply(function(){t.$eval(i.onuploaderror,{error:r,status:o,xhr:s})}):e.dialog.alert("   e,     :</br>: "+o+"<br/>: "+r+"<br/>: "+s.responseText,"   "))},i.uploadurl)},t.__upload=function(n){i.onfiles&&t.$eval(i.onfiles,{$files:$(n)[0].files}),i.noupload||e.uploader.upload(null,n,null,function(n,r,o,s){n?t.$tryApply(function(){i.onupload&&t.$eval(i.onupload,{$result:n})}):(console.error("upload error",r,o,s.responseText),i.onuploaderror?t.$tryApply(function(){t.$eval(i.onuploaderror,{error:r,status:o,xhr:s})}):e.dialog.alert("   e,     :</br>: "+o+"<br/>: "+r+"<br/>: "+s.responseText,"   "))})}}}}),e):void 0}),define("the-angular-dialog",["the-angular","the-angular-unsafe"],function(e){return e(function(t){if(null!=t.modules){var n=function(t){var n=t;return t.setupElement=function(e,t){var n=$(e);n.addClass("toolwindow dialog"),n.addClass(t.theDialog||"modal");var i=n.children("form");(null==i||0==i.length)&&(i=$('<form name="handler.forms.dialog"></form>').appendTo(n)),n=i,0==n.children(".content").length&&($("<div ng-show='handler.template||handler.getTemplate' class='content'></div>").appendTo(n),$("<div ng-show='!(handler.template||handler.getTemplate)' class='content' ng-include='handler.getView()'></div>").appendTo(n)),0==n.children(".title").length&&$("<label class='title'><span ng-bind='handler.getLabel()'></span><div class='tbt'><i class='fa fa-remove closer' ng-click='handler.close()'></i></div></label>").prependTo(n),0==n.children("nav").length&&$("<nav><i ng-if='handler.getShowExpand() && !handler.expanded' ng-click='handler.expand()' style='cursor:pointer' class='icon iprimary fa fa-arrows-alt'></i><i ng-if='handler.getShowExpand() && handler.expanded' ng-click='handler.collapse()' class='icon iprimary fa fa-compress'></i><i ng-if='handler.getShowSuccess()' ng-click='[handler.validate(),!handler.isValid || handler.success()]' class='button success' ng-disabled='!handler.validate()' ng-bind='handler.getSuccessText()'></i><i ng-if='handler.getShowCancel()' ng-click='handler.close()' class='button default'></i></nav>").appendTo(n),0==$(document.body).children(".modalback").length&&$('<div class="modalback"></div>').appendTo(document.body)},t._initialized=!1,t.init=function(){t._initialized||(0==$(document.body).children(".modalback").length&&$('<div class="modalback"></div>').appendTo(document.body),t.modalBack=$(document.body).children(".modalback"),$(document).keydown(function(e){return null==t.current?!0:27!=e.keyCode?!0:t.current.__handler?(t.current.__handler.close(),e.stopPropagation(),!1):!0}),t._initialized=!0)},t.modalCount=0,t.create=function(e){if(!angular)throw"cannot work without angular";var t=angular.element(document.body).scope(),n=angular.element(document.body).injector().get("$compile");if(!t)throw"cannot find root scope";var i=t.$new();if(e)if("function"==typeof e)i.initDialog=function(e,t,n){t(e,t,n)};else if(e.initDialog){for(var r in e)i[r]=e[r];i.initDialog=function(e,t,n){t.initDialog(e,t,n)}}else i.initDialog=function(t){for(var n in e)if("scope"==n)for(var r in e[n])i[r]=e[n][r];else t[n]=e[n]};var o=$('<div><div the-dialog class="fixed"></div></div>');return o=$(n(o.contents())(i)[0]),o.appendTo(document.body),i.$$phase||i.$apply(),i=angular.element(o[0]).scope(),o[0].__scope=i,o[0].__handler=i.handler,i.handler},t.alert=function(e,n,i,r){"object"==typeof e&&(n=e.label,i=e.callback,r=e.createOnly,e=e.message),e=String(e);var o=function(){return i&&i(s),!0},s=t.create({message:e,label:n,onSuccess:o,onCancel:o,showCancel:!1,autoremove:!0});return r||s.execute(),s},t.prompt=function(e,n,i,r,o){"object"==typeof e&&(n=e.label,i=e.value,r=e.callback,o=e.createOnly,e=e.message);var s=t.create({message:e,label:n,value:i,view:"--prompt-dialog.html",autoremove:!0,onSuccess:function(){return r&&r(!0,this.value),!0},onCancel:function(){return r&&r(!1),!0}});return o||s.execute(),s},t.confirm=function(e,n,i,r){"object"==typeof e&&(n=e.label,i=e.callback,r=e.createOnly,e=e.message);var o=t.create({message:e,label:n,view:"--message-dialog.html",autoremove:!0,onSuccess:function(){return i&&i(!0,this.value),!0},onCancel:function(){return i&&i(!1),!0}});return r||o.execute(),o},t.current=null,t.show=function(e){t.init();var n=$(e),i=n[0];if(!n.is(":visible")){var r=n.hasClass("modal");r&&(t.modalCount++,t.matchBackPosition(),i.__predialog=t.current,t.current=i);var o=1e4;r&&(o=1e4+10*(t.modalCount-1)),n.css("z-index",o),n.addClass("active"),t.resetonce=!1;var s=n.find(".content");t.reset=function(){var e=n[0].getBoundingClientRect(),o=window.innerWidth,a=window.innerHeight,u=a/2-e.height/2;u>100&&(u=50);var c=o/2-e.width/2;r&&(u+=20*(t.modalCount-1),c+=20*(t.modalCount-1)),n.css("top",u+"px"),n.css("left",c+"px"),s=n.find(".content.ng-scope"),t.resetonce||(s.on("mousewheel",function(e){i=e.currentTarget,e=e.originalEvent;var t=!1,n=e.wheelDelta<0;if(n){var r=i.scrollTop+i.clientHeight>=i.scrollHeight-2;r&&(t=!0)}else{var o=0==i.scrollTop;o&&(t=!0)}t&&e.preventDefault()}),t.resetonce=!0)},setTimeout(t.reset,300)}},t.matchBackPosition=function(){if(0==t.modalCount)t.modalBack.hide();else{var e=9995+10*(t.modalCount-1);t.modalBack.css("z-index",e),t.modalBack.show()}},t.hide=function(e){t.init();var n=$(e),i=n[0];if(n.is(":visible")){var r=null,o=n.hasClass("modal");o&&(t.modalCount>0&&t.modalCount--,t.current=i.__predialog,t.matchBackPosition()),angular&&(r=angular.element(n[0]).scope(),r&&r.handler&&r.$tryApply(function(){for(var e in r.handler.forms)r.handler.forms[e].$setPristine();r.item=""})),n.removeClass("active"),r&&r.handler.autoremove&&n.remove()}},t.initScope=function(n,i,r){var o=n.handler||(n.handler={forms:{},element:i,attr:r,isValid:!0,autoremove:!1,execute:function(){var e=this;t.show(i[0]),e.validate(),setTimeout(function(){n.$apply(function(){e.validate()})},100)},close:function(){(!this.onCancel||this.onCancel())&&t.hide(i[0])},reset:function(){t.reset()},success:function(){this.validate()&&(!o.onSuccess||o.onSuccess())&&t.hide(i[0])},validate:function(){if(this.isValid=!0,this.onValidate&&(this.isValid=this.onValidate()),this.isValid)for(var e in this.forms){var t=this.forms[e];if(t&&!t.$valid){this.isValid=!1;break}}return this.isValid},getLabel:function(){return this.label||r.label||""},getView:function(){var e=this.view||r.view||"--message-dialog.html";return e},refresh:function(){n.$tryApply()},getShowSuccess:function(){return"showSuccess"in this?!!o.showSuccess:"showSuccess"in r?!!r.showSuccess:!0},getShowCancel:function(){return"showCancel"in this?!!o.showCancel:"showCancel"in r?!!r.showCancel:!0},getShowExpand:function(){return"showExpand"in this?!!o.showExpand:"showExpand"in r?!!r.showExpand:!1},getSuccessText:function(){return"successText"in o?o.successText:"successText"in r?r.successText:""},expand:function(){this.expanded=!0,this.element.addClass("expanded")},collapse:function(){this.expanded=!1,this.element.removeClass("expanded"),this.element.find(".content").css("overflow-y","hidden");var e=this;setTimeout(function(){e.element.find(".content").css("overflow-y","auto")},100)},toggleExpand:function(){this.expanded?this.collapse():this.expand()}});if(e.$angular.directiveCall(n,r,"onInit","initDialog",{handler:o}),o.template||o.getTemplate){var s=(o.getTemplate?o.getTemplate():null)||o.template;if(s){var a=angular.element(document.body).injector().get("$compile"),u=$(a(s)(n)[0]),c=$(i[0]).children(".content")[0];$(c).empty(),u.appendTo(c)}}},t.linkElement=function(e,n,i){t.initScope(e,n,i)},t.setupModule=function(e){e.directive("theDialog",["$rootScope",function(){return{restrict:"A",scope:!0,compile:function(e,t){return n.setupElement(e,t),{pre:function(e,t,i){return n.linkElement(e,t,i)}}}}}]),e.run(["$templateCache","$sce",function(e){var t="<div ng-bind-html='handler.message | unsafe'></div>",n='<div ng-bind-html="handler.message | unsafe"></div><input style="width:100%" on-enter="!handler.isValid || handler.success()" autoselect ng-model="handler.value"/>';e.put("--message-dialog.html",t),e.put("--prompt-dialog.html",n)}])},t}(t.dialog||(t.dialog={}));t.modules.d_dialog=t.$angular.module("the-dialog",[]),n.setupModule(t.modules.d_dialog),n.setupModule(t.modules.all)}})}),define("the-angular-controlgroup",["the-angular"],function(e){return e(function(e){null!=e.modules&&e.modules.all.directive("theControlGroup",["ngClassDirective",function(e){var t=e[0];return{restrict:"A",compile:function(e,n){var i=$(e);i.addClass("control-group");var r=i.find("input, textarea, select");r.addClass("form-control");var o=i.parent().attr("name"),s=r.attr("name");n.ngClass="{'has-error':"+o+"."+s+".$invalid}",i.attr("ng-class","{'has-error':"+o+"."+s+".$invalid}");var a=$('<label class="control-label">'+n.label+"</label>").prependTo(i);return r.attr("required")&&$('<span class="validate" ng-show="'+o+"."+s+'.$error.required" class="help-inline">&nbsp;()</span>').appendTo(a),r.attr("ng-pattern")&&$('<span class="validate" ng-show="'+o+"."+s+'.$error.pattern" class="help-inline">&nbsp;('+n.patternDesc+")</span>").appendTo(a),r.attr("min")&&$('<span class="validate" ng-show="'+o+"."+s+'.$error.min" class="help-inline">&nbsp;(  '+r.attr("min")+")</span>").appendTo(a),{pre:function(e,n,i){t.link(e,n,i)}}}}}])})}),define("the-angular-viewcontext",["the-angular"],function(e){return e(function(e){null!=e.modules&&e.modules.all.factory("theViewContextHelper",["$rootScope",function(e){return{addEvents:function(t,n){n&&t&&(n=Array.isArray(n)?n:[n],n.forEach(function(n){var i=n.toUpperCase()+"EVENT";t[i]=i;var r="on"+n[0].toUpperCase()+n.substring(1);t[r]=function(t){e.$on(i,t)
};var o=n;t[o]=function(t,n){e.$broadcast(i,t,n)}}))}}}])})}),define("the-angular-onenter",["the-angular"],function(e){return e(function(e){if(null!=e.modules){var t=function(){return{link:function(e,t,n){$(t).bind("keyup",function(t){13==t.keyCode&&(t.preventDefault(),t.stopPropagation(),e.$apply(e.$eval(n.onEnter,{$event:t})))})}}},n=function(){return{link:function(e,t,n){$(t).bind("keyup",function(t){27==t.keyCode&&(t.preventDefault(),t.stopPropagation(),e.$apply(e.$eval(n.onEscape,{$event:t})))})}}};e.modules.d_onenter=e.$angular.module("the-onenter",[]).directive("onEnter",[t]),e.modules.d_onescape=e.$angular.module("the-onescape",[]).directive("onEscape",[n]),e.modules.all.directive("onEnter",[t]),e.modules.all.directive("onEscape",[n])}})}),define("the-design-stackedbutton",["the-root"],function(e){return e(function(t){if(null!=t.modules){var n=function(){return{scope:!0,templateUrl:"views/the/stacked-button.html?ver="+e.ver,link:function(t,n,i){t.useCheck="checker"in i;var r=i.type;t.innertype=function(){return t.useCheck?t.check()?"fa-check":"fa-remove":t.useinner()?"fa-"+i.marker:void 0},t.useinner=function(){return t.useCheck||"marker"in i},t.isPdf=function(){return t.fronttype().match(/pdf/)},t.backtype=function(){return r.match(/^file-?.*-o$/)?"fa-file":"question-circle"==r?"fa-question":void 0},t.fronttype=function(){return"fa-"+r},t.useCheck&&(t.check=function(){return t.$eval(i.checker)}),t.usehelp="help"in i,t.serverPrint=t.serverPrint||function(){e.printer.serverPrint({Target:"_blank"})},t.canPrint="undefined"!=typeof jsPrintSetup,t.doPrint=t.doPrint||function(){setTimeout(function(){e.printer.print()},1e3)},t.showHelp=function(e){"object"==typeof e?(e.preventDefault(),e.stopPropagation(),window.open("wiki?"+i.help)):window.open("wiki?"+e)}}}};t.modules.s_button=t.$angular.module("the-stacked-button",[]).directive("theStackedButton",["$rootScope",n]),t.modules.all.directive("theStackedButton",["$rootScope",n])}})}),define("the-wiki",[],function(){return function(){var e={};e.beforePreprocess=null,e.afterPreprocess=null,e.preprocess=function(e){e.text=e.text||"";var t=e.text;this.beforePreprocess&&(t=this.beforePreprocess(e,t));var t="\n"+e.text.trim()+"\n";return t=t.replace(/\r/g,""),t=t.replace(/\n\n+/g,"\n\n[BR]\n\n"),t=t.replace(/\n([\=\%\!\-\|])([^\n]+)/g,"\n\n$1$2\n\n"),t=t.replace(/(\[\[\/?\w+([^\]]*)\]\])/g,"\n\n\n\n$1\n\n\n\n"),t=t.replace(/\n\n+/g,"__LINER__"),t=t.replace(/\n/g,"&nbsp;"),t=t.replace(/__LINER__/g,"\n"),this.afterPreprocess&&(t=this.afterPreprocess(e,t)),t},e.beforeInline=null,e.afterInline=null,e.processInline=function(e,t){return this.beforeInline&&(t=this.beforeInline(e,t)),t=t.replace(/\*\*\*([\s\S]+?)\*\*\*/g,"<strong>$1</strong>"),t=t.replace(/\*\*([\s\S]+?)\*\*/g,"<em>$1</em>"),t=t.replace(/__([\s\S]+?)__/g,"<ins>$1</ins>"),t=t.replace(/--([\s\S]+?)--/g,"<del>$1</del>"),t=t.replace(/,,([\s\S]+?),,/g,"<sub>$1</sub>"),t=t.replace(/::([\s\S]+?)::/g,"<sup>$1</sup>"),t=t.replace(/\{style:([\s\S]+?)\}([\s\S]+?)\{style\}/g,'<span style="$1">$2</span>'),this.afterInline&&(t=this.afterInline(e,t)),t},e.beforeLine=null,e.afterLine=null,e.processLine=function(e,t){return this.beforeLine&&(t=this.beforeLine(e,t)),t=t.trim(),t=t.match(/^======/)?"<h6 id='h_"+e.idcount++ +"'>"+t.substring(6)+"</h6>":t.match(/^=====/)?"<h5 id='h_"+e.idcount++ +"'>"+t.substring(5)+"</h5>":t.match(/^====/)?"<h4 id='h_"+e.idcount++ +"'>"+t.substring(4)+"</h4>":t.match(/^===/)?"<h3 id='h_"+e.idcount++ +"'>"+t.substring(3)+"</h3>":t.match(/^==/)?"<h2 id='h_"+e.idcount++ +"'>"+t.substring(2)+"</h2>":t.match(/^=/)?"<h1 id='h_"+e.idcount++ +"'>"+t.substring(1)+"</h1>":t.match(/^%%%%%%/)?"<div class='wiki-list wiki-list-6'>"+t.substring(6)+"</div>":t.match(/^%%%%%/)?"<div class='wiki-list wiki-list-5'>"+t.substring(5)+"</div>":t.match(/^%%%%/)?"<div class='wiki-list wiki-list-4'>"+t.substring(4)+"</div>":t.match(/^%%%/)?"<div class='wiki-list wiki-list-3'>"+t.substring(3)+"</div>":t.match(/^%%/)?"<div class='wiki-list wiki-list-2'>"+t.substring(2)+"</div>":t.match(/^%/)?"<div class='wiki-list wiki-list-1'>"+t.substring(1)+"</div>":t.match(/^/)?"<div class='wiki-list wiki-list-6 number'>"+t.substring(6)+"</div>":t.match(/^/)?"<div class='wiki-list wiki-list-5 number'>"+t.substring(5)+"</div>":t.match(/^/)?"<div class='wiki-list wiki-list-4 number'>"+t.substring(4)+"</div>":t.match(/^/)?"<div class='wiki-list wiki-list-3 number'>"+t.substring(3)+"</div>":t.match(/^/)?"<div class='wiki-list wiki-list-2 number'>"+t.substring(2)+"</div>":t.match(/^/)?"<div class='wiki-list wiki-list-1 number'>"+t.substring(1)+"</div>":t.match(/^\//)?"<div class='wiki-outline'>"+t.substring(1)+"</div>":"<p>"+t+"</p>",this.afterLine&&(t=this.afterLine(e,t)),t},e.beforeCode=null,e.afterCode=null,e.processCode=function(e,t){return this.beforeCode&&(t=this.beforeCode(e,t)),t=t.replace(/\&nbsp;/g," __BR__ "),t=t.replace(/\[BR\]/g," __BR__ "),t=t.replace(/\x20{4}/g," __TAB__ "),t=t.replace(/\t/g," __TAB__ "),t=t.replace(/</g,"__LT__"),t=t.replace(/&lt;/g,"__LT__"),t=t.replace(/&gt;/g,"__GT__"),t=t.replace(/&amp;/g,"__AMP__"),t=t.replace(/([!=+\-*\.\\\/;<>%\&\^\:\|]+)/g,"<span _CLASS_ATTR_'operator'>$1</span>"),t=t.replace(/\/\*/g,"<span _CLASS_ATTR_'comment'>"),t=t.replace(/\*\//g,"</span>"),t=t.replace(/(\#[^"']+)$/g,"<span _CLASS_ATTR_'comment'>$1</span>"),t=t.replace(/(^\#[\s\S]+)(?=__BR__)/g,"<span _CLASS_ATTR_'comment'>$1</span>"),t=t.replace(/\b((var)|(for)|(return)|(import)|(foreach)|(abstract)|(embed)|(while)|(case)|(switch)|(in)|(out)|(include)|(embed)|(private)|(public)|(protected)|(void)|(function)|(class)|(namespace)|(using)|(select)|(where)|(group by)|(order by)|(null)|(true)|(false))\b/g,"<span _CLASS_ATTR_'keyword'>$1</span>"),t=t.replace(/\b((int)|(string)|(DateTime)|(decimal)|(bool)|(nvarchar)|(datetime)|(bit)|(byte)|(float)|(long)|(bigint))\b/g,"<span _CLASS_ATTR_'type'>$1</span>"),t=t.replace(/([\{\}\[\]\(\),]+)/g,"<span _CLASS_ATTR_'delimiter'>$1</span>"),t=t.replace(/\\"/g,"_EQ_"),t=t.replace(/""/g,"_DQ_"),t=t.replace(/"([\s\S]+?)"/g,"<span _CLASS_ATTR_'string'>\"$1\"</span>"),t=t.replace(/_EQ_/g,'\\"'),t=t.replace(/_DQ_/g,'""'),t=t.replace(/(\b-?\d+(\.\d+)?)/g,"<span _CLASS_ATTR_'number'>$1</span>"),t=t.replace(/_CLASS_ATTR_/g,"class="),t=t.replace(/__TAB__/g,"&nbsp;&nbsp;&nbsp;&nbsp;"),t=t.replace(/__BR__/g,"<br/>"),t=t.replace(/&amp;lt;/g,"&lt;"),t=t.replace(/&amp;gt;/g,"&gt;"),t=t.replace(/__LT__/g,"&lt;"),t=t.replace(/__GT__/g,"&gt;"),t=t.replace(/__AMP__/g,"&amp;"),t+="<br/>",this.afterCode&&(t=this.afterCode(e,t)),t},e.referenceRegex=/\[([^\s\]]+?)(\s+([^|~\]]+?))?([\|~]([\s\S]+?))?\]/g,e.processReferences=function(t,n,i,r){return n=n.replace(e.referenceRegex,function(e,n,o,s,a,u){return i(t,e,n,o,s,a,u,r)})},e.defaultProcessReference=function(t,n,i,r,o,s,a){return e.getReference(t,(i||"").trim(),(o||i||"").trim(),(a||"").trim())},e.getCustomReference=null,e.getReference=function(e,t,n,i){if(this.getCustomReference){var r=null;if(r=this.getCustomReference(e,t,n,i),null!=r)return r}return t.match(/\.((png)|(gif)|(jpg)|(jpeg))$/)?"<img src='"+t+"' title='"+n+"' "+i+" />":t.match(/^http/)||t.match(/\.html$/)?"<a href='"+t+"' "+i+" >"+n+"</a>":t.match(/^href:/)?"<a href='"+t.replace("href:","")+"' "+i+" >"+n+"</a>":"<a href='/wiki?"+t+"' "+i+" >"+n+"</a>"},e.setup=function(){},e.create=function(t,n){var i={text:t,lines:null,processed:[],html:null,log:n||function(){},processDefault:function(t){if(t.match(/^\!/))return t=t.substring(1),void this.processed.push(t);if("[BR]"!=t)return t=e.processInline(this,t),t=e.processReferences(this,t,e.defaultProcessReference,null),t=e.processLine(this,t)},idx:0,idcount:1,curline:"",nowikiblock:!1,codeblock:!1,table:!1,firstrow:!1,idcount:1,process:function(){this.processed=[],this.html="",this.processed.push("<div class='wiki'>"),this.log(this,"start");var t=e.preprocess(this);for(this.log(this,"lines merged"),this.lines=t.split(/\r?\n/),this.log(this,"text splited"),this.idx=0;this.idx<this.lines.length;this.idx++){var n=this.lines[this.idx];if(!n.match(/^\s*$/))if("[[/code]]"!=n)if("[[code]]"!=n)if(this.codeblock)this.lastcode+=n.replace(/(&nbsp;)|(\[BR\])/g,"\n")+"\r\n",this.processed.push(e.processCode(this,n));else if("[[/nowiki]]"!=n)if("[[nowiki]]"!=n)if(this.nowikiblock)this.processed.push(n);else if("[[/script]]"!=n)if(n.match(/\[\[script\s+type=([\w\/]+)\]\]/))this.scriptblock=!0,this.scripttype=n.match(/type=([\w\/]+)/)[1],this.script="";else if(n.match(/\[\[script-last\s+type=([\w\/]+)\]\]/)){this.scripttype=n.match(/type=([\w\/]+)/)[1],this.script=this.lastcode;var i=!0;if(e.scriptHandler){var r=e.scriptHandler(this,this.scripttype,this.script);r&&(i=!1,this.processed.push(r))}i&&(this.processed.push("<script type='"+this.scripttype+"'>"),this.processed.push(this.script),this.processed.push("</script>"))}else if(this.scriptblock)this.script+=n.replace(/(&nbsp;)|(\[BR\])/g,"\n");else{if(n.match(/^\|/))this.table||(this.processed.push("<table>"),this.processed.push("<thead>"),this.table=!0,this.ishead=!0);else{if("[[row]]"==n){this.cellstart&&(this.cellstart=!1,this.processed.push("</td>")),this.rowstart&&this.processed.push("</tr>"),this.table||(this.processed.push("<table><tbody>"),this.table=!0),this.rowstart=!0,this.processed.push("<tr>");continue}if("[[cell]]"==n){this.cellstart&&this.processed.push("</td>"),this.table||(this.processed.push("<table><tbody><tr>"),this.table=!0,this.rowstart=!0),this.cellstart=!0,this.processed.push("<td>");continue}if("[[/cell]]"==n){this.cellstart=!1,this.processed.push("</td>");continue}if("[[/row]]"==n){this.cellstart&&this.processed.push("</td>"),this.cellstart=!1,this.rowstart=!1,this.processed.push("</tr>");continue}this.table&&(this.cellstart||(this.rowstart&&this.processed.push("</tr>"),this.processed.push("</tbody>"),this.processed.push("</table>"),this.table=!1,this.cellstart=!1,this.rowstart=!1))}if(!this.table||this.cellstart)if("[[sample]]"!=n)if("[[/sample]]"!=n)if("----"!=n){var o=this.processDefault(n);o&&this.processed.push(o)}else this.processed.push("<hr/>");else this.processed.push("</div>");else this.processed.push("<div class='sample'>");else{var s=this.ishead?"th":"td";this.ishead||n.match(/^\|\{\+\}/)&&(n=n.replace(/^\|\{\+\}/,"|"),this.ishead=!0,suffix="",s="th");var a=n.split(/\|/),u="";this.ishead||(u+="</thead></tbody>"),this.ishead=!1,u+="<tr>";for(var c=0;c<a.length;c++)if(0!=c&&c!=a.length-1){var l=a[c].trim();l=e.processInline(this,l),l=e.processReferences(this,l,e.defaultProcessReference,null);var h=l.match(/^\{(\d+)?(,(\d+))?\}/);if(h){l=l.replace(/^\{(\d+)?(,(\d+))?\}/,"");var f=1,d=1;h[1]&&(d=h[1]),h[3]&&(f=h[3]),u+="<"+s+" rowspan='"+f+"' colspan='"+d+"' >"+l+"</"+s+">"}else u+="<"+s+">"+l+"</"+s+">"}u+="</tr>",this.processed.push(u)}}else{this.scriptblock=!1;var i=!0;if(e.scriptHandler){var r=e.scriptHandler(this,this.scripttype,this.script);r&&(i=!1,this.processed.push(r))}i&&(this.processed.push("<script type='"+this.scripttype+"'>"),this.processed.push(this.script),this.processed.push("</script>"))}else this.nowikiblock=!0;else this.nowikiblock=!1;else this.codeblock=!0,this.lastcode="",this.processed.push("<div class='wiki-code'>");else this.codeblock=!1,this.processed.push("</div>")}this.processed.push("</div>"),this.html="";for(var c=0;c<this.processed.length;c++){var p=this.processed[c].replace(/__BLOCK__/g,"[[");this.html+=p}}};return this.setup(i),i},e.createTOC=function(t,n){var i={text:t,lines:null,processed:[],html:null,log:n||function(){},processReference:function(e,t,n,i,r,o,s,a){var n=(n||"").trim(),u=(r||n||"").trim(),s=(s||"").trim();a.addr=n,a.title=u,a.extension=s},processDefault:function(t){if(!this.nowiki){if("[[nowiki]]"==t)return void(this.nowiki=!0);if("[[/nowiki]]"==t)return void(this.nowiki=!1);if(!t.match(/^\!/)&&t.match(/^\=/)){var n=0;if(t.match(/^======/)?(n=6,t=t.substring(6).trim()):t.match(/^=====/)?(n=5,t=t.substring(5).trim()):t.match(/^====/)?(n=4,t=t.substring(4).trim()):t.match(/^===/)?(n=3,t=t.substring(3).trim()):t.match(/^==/)?(n=2,t=t.substring(2).trim()):t.match(/^=/)&&(n=1,t=t.substring(1).trim()),0==n)return null;t=e.processInline(this,t);var i={level:n,raw:t,items:[]};if(t=e.processReferences(this,t,this.processReference,i),1==n)this.json.items.push(i),i.parent=this.json;else if(null!=this.last)if(n==this.last.level)this.last.parent.items.push(i),i.parent=this.last.parent;else if(n==this.last.level+1)this.last.items.push(i),i.parent=this.last;else if(n<this.last.level){for(var r=this.last;n<=r.level;)r=r.parent;r.items.push(i),i.parent=r}this.currentLevel=n,this.last=i,this.json.all=this.json.all||[],this.json.all.push(i)}}},idx:0,curline:"",currentLevel:0,last:null,nowiki:!1,process:function(){this.processed=[],this.json={items:[]},this.log(this,"start");var t=e.preprocess(this);for(this.log(this,"lines merged"),this.lines=t.split(/\n/),this.log(this,"text splited"),this.idx=0;this.idx<this.lines.length;this.idx++)this.processDefault(this.lines[this.idx]);if(this.json.all)for(var n=0;n<this.json.all.length;n++)delete this.json.all[n].parent;delete this.json.all}};return this.setup(i),i},e.toHTML=function(e){var t=this.create(e);t.process();var n=t.html;return delete t,n},e.toTOC=function(e){var t=this.createTOC(e);t.process();var n=t.json;return delete t,n};var t=1;return e.scriptHandler=function(e,n,i){if("bxl"==n||"bsharp"==n){t++;var r=t;return window.setTimeout(function(){$.ajax({method:"POST",url:"toxml?lang="+n+"&format=wiki",data:i}).done(function(e){$("#dynwiki_"+r).html(e)})},300),"<div id='dynwiki_"+r+"' class='dynwiki "+n+"'></div>"}return null},e}()}),define("the-menu",[],function(){function MenuGenerator(el,attrs){var self=this;this.rootElement=el,this.modelName=attrs.model||attrs.Model||null,this.wrapperName=attrs.wrapper||attrs.Wrapper||"",this.filterName=attrs.filter||attrs.Filter||"",this.generateSubmenu=function(e){if(e.items=e.Items||null,e.items){var t=$('<div class="submenu"/>');return e.items.forEach(function(e){var n=self.generateMenuItem(e);t.append(n)}),t}},this.generateMenuItem=function(e){e.type=e.type||e.Type||"text",e.name=e.name||e.Name;var t=this.generateMenuItemBase(e);if("divider"==e.name)return $('<div class="menu__item menu__item-divider" type="divider"/>');switch(e.type){case"text":t.append(this.generateTextItem(e));break;case"icon":t.append(this.generateIconItem(e));break;case"icon_with_text":t.append(this.generateIconItem(e)).append(this.generateTextItem(e));break;case"view":t.append(this.generateViewItem(e))}if(e.items=e.Items||null,e.items){var n=this.generateSubmenu(e);t.append(n)}return t},this.generateTextItem=function(e){return $('<div class="menu__item-title menu__item-element" />').text(e.Name)},this.generateViewItem=function(e){var t=$('<div class="menu__item-view menu__item-element" />'),n=e.attr("view");return t.append("<ng-include src=\"'"+(-1!=n.indexOf(".html")?n:n+".html")+"'\" />"),t},this.generateIconItem=function(e){var t=$('<div class="icon menu__item-icon menu__item-element" menu-icon="1" />'),n=e.icon||e.Icon||e.iconclass;return n&&""!=n&&t.append(-1!=n.indexOf("/")?$("<img />").attr("src",n):$("<i/>").addClass(n)),t},this.generateMenuItemBase=function(e){var t=$('<div class="menu__item menu__item-element" />').attr("type",e.type);return t.addClass("menu__item-"+(e.size?e.size:"small")),e.items=e.items||e.Items||null,e.model=e.model||e.Model||null,e.code=e.code||e.Code||null,e.items||e.model?(t.attr("menu-group","1"),t.addClass("open-right")):t.attr("menu-item","1"),e.action=e.action||e.Action||null,e.action&&this.modelName&&!e.items&&t.attr("ng-click","exec("+this.modelName+", '"+e.code+"')"),t},this.copyAttrs=function(e){var t=["ng-if"];Object.keys(e).forEach(function(){-1!=$.inArray(t)})},this.isItemFiltered=function(item,filterAttr){var filter=eval("({"+filterAttr+"})"),result=!1;return filter.filter&&(filter=filter.filter),Object.keys(filter).forEach(function(e){item[e]&&(result=item[e]!=filter[e])}),result},this.generateMenu=function(e){var t=$("<div/>");return e instanceof Array&&e.forEach(function(e){self.filterName&&""!=self.filterName?!self.isItemFiltered(e,self.filterName)&&t.append(self.generateMenuItem(e)):t.append(self.generateMenuItem(e))}),t}}if("undefined"!=typeof document){$(document).on("click",function(){$(".menu__item.hover").removeClass("hover")});var getRandomHsl=function(){var e=Math.floor(360*Math.random()),t=Math.floor(20*Math.random())+50,n=Math.floor(20*Math.random())+50;return{h:e,s:t,l:n}},colorLuminance=function(e,t){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var n,i,r="#";for(i=0;3>i;i++)n=parseInt(e.substr(2*i,2),16),n=Math.round(Math.min(Math.max(0,n+n*t),255)).toString(16),r+=("00"+n).substr(n.length);return r};angular.module("Menu",[]).directive("menu",["$compile",function(e){var t=function(e,t){var n=e.find("div:last-child>.menu__item"),i=e.find("div:first-child>.menu__item");i.removeClass("active"),i.filter('[code="'+t+'"]').first().addClass("active"),n.hide(),n.filter('[group="'+t+'"]').show()};return{restrict:"A",link:function(n,i,r){i=$(i);var o=n.settings.get(r.id);r.model&&n.$watch(r.model,function(){var t=new MenuGenerator(i,r),o=angular.element(t.generateMenu(n[r.model]).html()),s=e(o)(n);i.find(".menu__horizontal").empty().append(s)});var s=function(){if(i.on("click","div:first-child>.menu__item",function(e){var o=$(e.currentTarget.classList.contains("menu__item")?e.currentTarget:e.currentTarget.parentElement).attr("code");n.settings.set(r.id,{activegroup:o}),t(i,o)}),o.activegroup)t(i,o.activegroup);else{var e=i.find("div:first-child>.menu__item[default]").first();0==e.length&&(e=i.find("div:first-child>.menu__item").first());var s=e.attr("code");n.settings.set(r.id,{activegroup:s}),t(i,s)}},a=function(){i.on("mouseenter",".menu__item>.menu__item-element",function(e){$(".menu__item.hover").removeClass("hover");var t=$(e.target).parents(".menu__item[menu-group]");t.addClass("hover"),$(window).width()-(t.first().offset().left+t.first().outerWidth())<200?t.first().addClass("open-left").removeClass("open-right"):t.first().addClass("open-right").removeClass("open-left")})};"ribbon"==r.menu?s():"inline"==r.menu||"dropdown"==r.menu&&a(),i.on("click",".menu__item",function(e){var t=$(e.target),n=t.hasClass(".menu__item")?t:t.parents(".menu__item").first();n.attr("url")&&window.open(n.attr("url"),"_blank")})}}}]).directive("menuItem",["$compile",function(e){return{restrict:"A",link:function(t,n,i){n=$(n),i.model&&t.$watch(i.model,function(){var r=new MenuGenerator(n,i),o=angular.element(r.generateMenu(t[i.model]).html()),s=e(o)(t);n.find(".submenu").first().empty().append(s)}),i.url&&i.model&&$.getJSON(i.action,{},function(e){t[i.model]=e})}}}]).directive("menuIcon",function(){return{restrict:"A",link:function(e,t,n){t=$(t);var i,r,o=n.color;if(!o&&t.parent()&&(o=t.parent().attr("color")),o)i=0==o.indexOf("#")?o:"#"+o,r=colorLuminance(i,-.5);else{var s=getRandomHsl();i="hsl("+s.h+","+s.s+"%,"+s.l+"%)",r="hsl("+(s.h+10)+","+s.s+"%,"+(s.l-20)+"%)"}t.css("background","linear-gradient(to top, "+i+","+r+")")}}}).directive("menuGroup",["$compile",function(e){return{restrict:"A",link:function(t,n,i){if(n=$(n),i.model){var r=new MenuGenerator(n,i);t.$watch(i.model,function(){var o=angular.element(r.generateMenu(t[i.model]).html()),s=e(o)(t);n.find(".submenu").first().empty().append(s)})}if("icon_with_text"==i.type||"icon"==i.type){var o=i.color;if(!o&&n.parent()&&(o=n.parent().attr("color")),o){var s,a;s=0==o.indexOf("#")?o:"#"+o,a=colorLuminance(s,-.5),n.find(".icon").first().css("background","linear-gradient(to top, "+s+","+a+")")}else{var u=getRandomHsl();n.find(".icon").first().css("background","linear-gradient(to top, hsl("+u.h+","+u.s+"%,"+u.l+"%),hsl("+(u.h+10)+","+u.s+"%,"+(u.l-20)+"%))")}}}}}])}}),define("the-settings",["the-root"],function(e){function t(){var e=this;Object.keys(localStorage).forEach(function(t){var n=localStorage.getItem(t);e[t]=e.isJson(n)?JSON.parse(n):n})}"undefined"!=typeof angular&&(t.prototype.set=function(e,t){if("object"==typeof e){var n=this;Object.keys(e).forEach(function(t){n.set(t,e[t])})}else if("string"==typeof e)return"object"==typeof t?(this[e]=t,t=JSON.stringify(t)):this[e]=this.isJson(t)?JSON.parse(t):t,localStorage.setItem(e,t),t},t.prototype.isJson=function(e){return"string"==typeof e&&""!=e&&(0==e.trim().indexOf("{")||0==e.trim().indexOf("[")||"true"==e.trim()||"false"==e.trim())},t.prototype.get=function(e){return this[e]||(this[e]=!1,localStorage.setItem(e,"false")),this[e]},angular.module("settings",[]).factory("settings",["$rootScope",function(n){var i=new t,r=function(e){e.settings=i,e.$watch("settings",function(t,n){Object.keys(t).forEach(function(i){t[i]!=n[i]&&e.settings.set(i,t[i])})},!0)};return r.set=function(e,t){return i.set(e,t)},r.get=function(e){return i.get(e)},r.setup=function(t){var i=e.extend(t["default"]||{},r.get(t.name));return n.$watch(function(){return i},function(){r.set(t.name,i)},!0),t.init&&t.init(i),i.initialize&&i.initialize(),i},r}]))}),define("the-errorcatcher",[],function(){"undefined"!=typeof angular&&angular.module("ErrorCatcher",[]).factory("$exceptionHandler",function(){return function(e){var t=$('<div id="extraHelp" />');$("body").html(t);var n="error.assoi@ugmk.com",i="[auto] -   ",r=e.stack;t.html('<a href="mailto:'+n+"?subject="+i+"&body="+r+'">-   ,  !</a><div>'+r+"</div>")}})}),define("the-refresh",[],function(){"undefined"!=typeof angular&&angular.module("refresh",[]).factory("refresh",["$http","$timeout",function(e,t){return function(n,i){i=i||{},i.timeout=i.timeout||5e3,i.lag=i.lag||1e3,i.delayed=i.delayed||!1,i.validate=i.validate||function(){return!0},i.target&&!i.success&&(i.success="string"==typeof i.target?function(e){n["set"+i.target]?n["set"+i.target](e):n[i.target]=e}:function(e){i.target.values=e}),i.target||i.success||(i.success=function(e){n.data=e});var r=n;i.target&&(r=n[i.target+"_refresh"]={}),r.refresh={runSync:function(){var t=i.http;"function"==typeof t&&(t=t()),e(t).success(function(e,t,n,r){i.onsuccess?i.onsuccess(e,t,n,r):console.log(e,t,n,r)}).error(function(e,t,n,r){i.onerror?i.onerror(e,t,n,r):console.log(e,t,n,r)})},runWithAction:function(){var e=i.args||{};if("function"==typeof e&&(e=e()),i.validate(e)){var t={success:i.success,error:i.error};i.delayed&&(t.delay=500),i.action(e,t)}},runASyncWithAction:function(){var e=i.args||{};"function"==typeof e&&(e=e()),i.action.begin(e),t(function(){i.action.end(e,function(e,t,n,r){i.success?i.success(e,t,n,r):console.log(e,t,n,r)},function(e,t,n,r){i.error?i.error(e,t,n,r):console.log(e,t,n,r)})},i.lag)},runASync:function(){e(i.httpstart),t(function(){e(i.httpend).success(function(e,t,n,r){i.success?i.success(e,t,n,r):console.log(e,t,n,r)}).error(function(e,t,n,r){i.error?i.error(e,t,n,r):console.log(e,t,n,r)})},i.lag)},run:function(e){!!e&&e.stopPropagation(),i.action?i.async?this.runASyncWithAction():this.runWithAction():i.async?this.runASync():this.runSync()},auto:!1,changeAuto:function(e){!!e&&e.stopPropagation(),i.persistentCode&&localStorage.setItem(i.persistentCode,this.auto),this.checkAuto()},timeout:null,checkAuto:function(){if(this.auto){if(!this.timeout){var e=this;this.timeout=t(function(){e.run(),e.timeout=null,e.checkAuto()},i.timeout)}}else this.timeout&&(t.cancel(this.timeout),this.timeout=null)}},r.refresh.run(),r.refresh.auto=!!i.auto,!r.refresh.auto&&i.persistentCode&&(r.refresh.auto=!!JSON.parse(localStorage.getItem(i.persistentCode)||"false")),r.refresh.checkAuto()}}])}),define("the-domutils",["the-root"],function(e){var t=e.$jQuery;if(!t)return console.error("JQuery required"),e;t.fn.exists=function(){return 0!==this.length},t.fn.fst=function(){return 0!==this.length?this[0]:null},t.fn.csss=function(e){var n={};return this.each(function(i,r){e.forEach(function(e){n[e]=t(r).css(e)})}),n};var n={},i=n.maxWidth=function(e,n){e=t(e),n=n||t(window).width();var i=e.css("max-width");return i&&i.match(/px$/)&&"0px"!=i?Number(i.match(/\d+/)):n};t.fn.maxWidth=function(e){var t=[];return 0!==this.length&&this.each(function(n,r){t.push([i(r,e),r])}),t};var r=n.minWidth=function(e,n){e=t(e),n=n||50;var i=e.css("min-width");return i&&i.match(/px$/)&&"0px"!=i?Number(i.match(/\d+/)):n},o=n.absolutize=function(e){e=t(e),e.css("position","absolute"),e.css("top","auto"),e.css("bottom","auto"),e.css("left","auto"),e.css("right","auto")},s=n.isrelative=function(e){e=t(e);var n=e.css("position");return"relative"==n||"absolute"==n};t.fn.minWidth=function(e){var t=[];return 0!==this.length&&this.each(function(n,i){t.push([r(i,e),i])}),t};var a=n.ensureVisibility=function(e,n,i){e=t(e),n=n||"flex";var r=e.css("display");return"none"!=r?!1:(e.css("visibility","hidden"),e.css("display",n),i&&e.css("position","absolute"),!0)},u=n.restoreVisibility=function(e,n){n!==!1&&(e=t(e),e.css({display:"",visibility:"",position:""}))},c=n.FitWidthOptions=function(){this.min=50,this.max=t(window).width()/2,this.step=100,this.corrector=10,this.cache=!1,this.reset=!1,this.apply=!0,this.defaultDisplay="flex",this.absolutize=!0};fitWidthMarker=c.CacheMarker="__hasFitWidth";var l=(c.Default=new c,n.fitWidth=function(n,o){if(n=t(n),n.exists()){if(o=e.cast(c,o),el=n.fst(),o.cache&&!o.reset&&o.apply&&el[fitWidthMarker])return el[fitWidthMarker];var s=a(n,o.defaultDisplay,o.absolutize);n.css("overflow-y","none"),n.css("word-break","break-all"),n.height("auto");var l=Math.min(i(n),o.max),h=Math.min(r(n),o.min),f=n.width(),d=n.height();n.width(l);for(var p=n.height(),m=l;m>h;){if(n.width(m-o.step),n.height()>p){for(var g=m-o.step+o.corrector;m>=g;){if(n.width(g),n.height()<=p){n.width(g);break}g+=o.corrector}break}m-=o.step}var v=n.width(),y=n.height();o.cache&&o.apply&&(el[fitWidthMarker]=v),o.apply||n.width(f),u(n,s);var b={width:v,height:y,beforeWidth:f,beforeHeight:d};return b}});t.fn.fitWidth=function(e){return 0!==this.length&&this.each(function(t,n){l(n,e)}),this},t.fn.suggestWidth=function(t){var n=[];return 0!==this.length&&(t=e.cast(c,t),t.apply=!1,this.each(function(e,i){n.push([l(i,t),i])})),n},PlaceAsidePositions=n.PlaceAsidePositions={};var h=PlaceAsidePositions.up="up",f=PlaceAsidePositions.down="down",d=PlaceAsidePositions.right="right",p=PlaceAsidePositions.left="left",m=PlaceAsidePositions.top="top",g=PlaceAsidePositions.down="bottom",v=PlaceAsidePositions.BL={side:g,v:f,h:p},y=PlaceAsidePositions.BR={side:g,v:f,h:d},b=PlaceAsidePositions.TL={side:m,v:h,h:p},_=PlaceAsidePositions.TR={side:m,v:h,h:d},x=PlaceAsidePositions.RD={side:d,v:f,h:d},w=PlaceAsidePositions.RU={side:d,v:h,h:d},$=PlaceAsidePositions.LD={side:p,v:f,h:p},k=PlaceAsidePositions.LU={side:p,v:h,h:p},C=PlaceAsidePositions.Default=[y,v,_,b,x,w,$,k],S=n.PlaceAsideOptions=function(){this.fitwidth=!0,this.target=null,this.detach=!1,this.apply=!0,this.cache=!1,this.reset=!1,this.overlap=1,this.positions=C,this.defaultDisplay="flex",this.maxWidth=t(window).width()/2,this.minWidth=100,this.fitWidthStep=100,this.fixedContent=!1,this.padding=20},T=function(t,n){el=t.fst();var i=a(t,n.defaultDisplay,!0),r=e.extend({},el.getBoundingClientRect());if(n.fitwidth){var o=l(t,{min:n.minWidth,max:n.maxWidth,step:n.fitWidthStep,cache:n.fixedContent,apply:n.apply});e.extend(r,o)}return u(i),r},O=function(e,t,n,i){var r=0;r=e.v==h?e.side==m?t.top:t.bottom:e.side==g?n.height-t.bottom:n.height-t.top;var o=0;o=e.h==d?e.side==d?n.width-t.right:n.width-t.left:e.side==p?t.left:t.right,e.width=o-i.padding,e.height=r-i.padding},D=function(e,t){e.fitwidth=t.width<=e.width?!0:e.width,e.fitheight=t.height<=e.height?!0:e.height,e.fit=e.fitheight===!0&&e.fitwidth===!0},j=function(n,i,r){var o={width:t(window).width(),height:t(window).height()},s=[];r.positions&&0!=r.positions.length||(r.positions=PlaceAsidePositions.Default),r.positions.forEach(function(t){"string"==typeof t&&(t=PlaceAsidePositions[t]);var a=e.extend({},t);O(a,i,o,r),D(a,n),s.push(a)});for(var a=null,u=0;u<s.length;u++)if(s[u].fit){a=s[u];break}if(null==a)for(var u=0;u<s.length;u++)if(s[u].fitwidth===!0){a=s[u];break}if(null==a)for(var u=0;u<s.length;u++)if(s[u].fitheight===!0){a=s[u];break}return null==a&&(a=s[0]),a},E=function(e,t){t.fitwidth!==!0&&(e.outerWidth(t.fitwidth),e.outerHeight()>t.height&&(t.fitheight=t.height)),t.fitheight!==!0&&(e.css("overflow-y","auto"),e.outerHeight(t.fitheight))},P=function(e,n){var i=t(n.target||e.parent());return i.fst()!=e.parent().fst()&&(e.detach(),e.appendTo(t(i))),i},A=function(e,t,n,i,r){var o={top:"auto",bottom:"auto",left:"auto",right:"auto"};if(i.side==m||i.side==g){var s=t.height-r.overlap;i.h==d?o.left=0:o.right=0,i.side==m?o.bottom=s:o.top=s}else{var a=t.width-r.overlap;i.v==h?o.bottom=0:o.top=0,i.side==p?o.right=a:o.left=a}"auto"!=o.top&&(o.top=o.top+="px"),"auto"!=o.bottom&&(o.bottom=o.bottom+="px"),"auto"!=o.left&&(o.left=o.left+="px"),"auto"!=o.right&&(o.right=o.right+="px"),e.css(o)},R=n.placeAside=function(n,i){if(n=t(n),n.exists()){i=e.cast(S,i);var r=n.csss(["top","bottom","left","right"]),a=P(n,i);o(n);var u=a.fst().getBoundingClientRect(),c=T(n,i),l=j(c,u,i);E(n,l);var h=s(a);h||(a.css("position","relative"),h=!0),A(n,u,h,l,i);var f=n.fst().getBoundingClientRect(),d={base:c,result:f};return i.apply||n.css(r),d}};t.fn.placeAside=function(e){this.each(function(t,n){R(n,e)})};var I=e.$angular;return I&&I.module("the-domutils",[]).factory("the-domutils",[function(){return n}]),e(function(e){e.domutils=n})}),define("the-dropdown",["the-root"],function(e){var t=e.$jQuery,n=e;if(!t)return console.error("JQuery required"),e;if(null!=n.modules){var i={__closeDropDown:function(e){t(e).removeClass("shown"),t(e).removeClass("isdropdown");var n=e.__ddoptions;e.__ddoptions=null,e.__ddopened=!1,n.onclose&&n.onclose(e,n)},__closeDropDownContainer:function(e,n){$e=t(e),e=$e[0];var i=this;if(e.__ddcopened&&(e.__ddcopened=!1,n=n||e.__options,t(e).children(".dropdown").each(function(e,t){i.__closeDropDown(t)}),t(e).find(".dropdown").each(function(e,r){r.__ddopened&&i.__closeDropDownContainer(t(r).parent(),n)}),n.detach&&!this.isNestedContainer(e))){var r=t(e);r.css("position",e.oldposition),r.css("top",e.oldtop),r.css("left",e.oldleft),r.css("z-index",e.oldindex),e.placeholder&&e.placeholder.hide()}},__doSelectByKeyboard:function(e,n){var i=t(e).find(".selected");if(0!=i.length)if(38==n){var r=i.prevAll(".selectable");r.length>0&&(t(r[0]).addClass("selected"),t(i[0]).removeClass("selected"))}else{var r=i.nextAll(".selectable");r.length>0&&(t(r[0]).addClass("selected"),t(i[0]).removeClass("selected"))}else{var o=t(e).find(".selectable");o.length>0&&t(o[0]).addClass("selected")}},__compileContainerElement:function(e,n){var i=this;$e=t(e),e=$e[0],$e.on("mouseleave",function(){e.__ddcopened&&(e.__timeout=setTimeout(function(){i.__closeDropDownContainer(e,n)},n.timeout))}),$e.on("mouseenter",function(){e.__ddcopened&&clearTimeout(e.__timeout)}),$e.find(".dropdown").on("mousewheel",function(t){if(e.__ddcopened){var n=t.currentTarget,t=t.originalEvent,i=!1,r=t.wheelDelta<0;if(r){var o=n.scrollTop+n.clientHeight>=n.scrollHeight-2;o&&(i=!0)}else{var s=0==n.scrollTop;s&&(i=!0)}i&&(t.preventDefault(),t.stopPropagation())}});var r=$e.find("input");r.length>0&&t(document).on("keydown",function(r){if(e.__ddcopened){if(38==r.keyCode||40==r.keyCode)return i.__doSelectByKeyboard(e,r.keyCode),r.preventDefault(),r.stopPropagation(),!1;if(13==r.keyCode){var o=$e.find(".selected");o.length>0&&setTimeout(function(){t(o[0]).click()},100),i.__closeDropDownContainer(e,n)}}}),e.__timeout=null,e.__ddcopened=!1,e.__ddcprepared=!0},__getOptions:function(e){return e=e||{},e.timeout||(e.timeout=500),e.detach=!0,e},__compileDropDown:function(e,n){var i=this;$e=t(e),e=$e[0],t(e).on("click",function(r){e.__ddopened&&(r.preventDefault(),r.stopPropagation(),n.menu||$e.hasClass("menu")?t(".dropdown.shown").each(function(e,r){i.__closeDropDownContainer(t(r).parent(),n)}):i.__closeDropDownContainer(t(e).parent(),n))}),e.__ddopened=!1,e.__ddprepared=!0},isNestedContainer:function(e){for(var t=!1,n=e.parentNode;null!=n;){if(n.__ddcopened){t=!0;
break}n=n.parentNode}return t},openDropdownElement:function(e,n){if(e=t(e).fst(),!e.__ddcopened){n=this.__getOptions(n),e.__ddcprepared||this.__compileContainerElement(e,n);var i=t(e).children(".dropdown");if(0!=i.length&&(i=i[0],i.__ddprepared||this.__compileDropDown(i,n),i.__ddoptions=n,t(i).placeAside(n),t(i).addClass("shown"),t(i).addClass("isdropdown"),i.__ddopened=!0,e.__ddcopened=!0,e.__options=n,n.onopen&&n.onopen(i,n),n.detach&&!this.isNestedContainer(e))){var r=e.getBoundingClientRect(),o=e.placeholder;o||(o=e.placeholder=t("<div/>"),o.insertAfter(e),o.hide());var s=t(e);o.css("min-width",s.outerWidth()),o.css("min-height",s.outerHeight()),o.css("margin",s.css("margin")),e.oldposition=s.css("position"),e.oldtop=s.css("top"),e.oldleft=s.css("left"),e.oldindex=s.css("z-index"),s.css("position","fixed"),s.css("top",r.top),s.css("left",r.left),s.css("z-index",1e4),e.placeholder.show()}}},openDropdown:function(e,n){var i=e.currentTarget?e.currentTarget:e;return 0==t(i).children(".dropdown").length?this.openDropdown(t(i).parent()[0]):this.openDropdownElement(i,n)}},r=function(e,t){return i.openDropdown(e,t)};r.close=function(){t(".dropdown").each(function(e,n){i.__closeDropDownContainer(t(n).parent())})},t.fn.openDropdown=function(e){this.each(function(t,n){r(n,e)})},t.closeDropdown=function(){r.close()},n.dropdown=r;var o=function(){return r};n.modules.ddservice=n.$angular.module("the-ddservice",[]).factory("dropdownService",o),n.modules.all.factory("dropdownService",o),n.modules.all.directive("ddInput",["dropdownService",function(e){return{link:function(t,n){var i=function(t){e(t)};n.bind("click",i),n.bind("keydown",i),n.bind("mouseenter",i)}}}])}}),define("the-uistate",["the-root"],function(e){return e(function(e){var t=e.uistate=e.uistate||{};t.groups=t.groups||{};var n=e.uistate.StateObject=function(e,t,n){this.code=e,this.group=t,this.system=!!n};Object.defineProperty(n.prototype,"active",{get:function(){return this.group.isActive(this.code)},set:function(e){this.group.activate(e?this.code:"null")}});var i=e.uistate.StateGroup=function(e,t,i,r){this.parent=t,this.code=e,this.activeObject=i||"null",this.toggleable=!0,this.defaultObject=r||"default",this.__visible=!0,this.get=function(e){return this.objects.hasOwnProperty(e)?this.objects[e]:this.objects[e]=new n(e,this)},this.getActive=function(){return this.get(this.activeObject)},this.activate=function(e){this.activeObject=this.toggleable&&this.activeObject==e?"none":e,console.debug(e,this.code,this.parent.sync),"toolbar"==this.code&&this.parent.sync&&this.parent.left.activate(e)},this.isActive=function(e){return this.activeObject==e},this.objects={"null":new n("null",this,!0),"default":new n("default",this,!0)},this.objects["default"].active=!0};Object.defineProperty(i.prototype,"visible",{set:function(e){this.__visible=e},get:function(){return this.activeObject&&"null"!=this.activeObject?!!this.__visible:!1}}),t.sync=!1,t.getGroup=function(e){return t.groups.hasOwnProperty(e)||(t.groups[e]=new i(e,t)),t.groups[e]},Object.defineProperty(t,"toolbar",{writeable:!1,get:function(){return t.getGroup("toolbar")}}),Object.defineProperty(t,"left",{writeable:!1,get:function(){return t.getGroup("left")}}),Object.defineProperty(t,"right",{writeable:!1,get:function(){return t.getGroup("right")}}),t.isActive=function(e,n){return t.getGroup(e).isActive(n)},t.activate=function(e,n){return t.getGroup(e).activate(n)},t.get=function(e,n){return t.getGroup(e).get(n)}})}),define("the-tools",["the-root"],function(e){var t=e.$jQuery,n=e;if(!t)return console.error("JQuery required"),e;if(null!=n.modules){var i=n.modules.all,r=n.uistate;i.filter("activeobjects",function(){return function(e){var t=[];for(var n in e)e[n].system||t.push(e[n]);return t}}),i.directive("theLeft",["dropdownService","$compile",function(e,n){return{restrict:"A",link:function(e,i){i=t(i[0]),i.addClass("left");var o=i.children("label"),s=null,a=!1;0==o.length&&(a=!0,o=t('<label class="title primary bordered"></label>').prependTo(i)),s=o.children("i"),0==s.length&&(a=!0,s=t("<i/>").prependTo(o)),o.find(".fa-remove").on("click",function(){e.$apply(function(){r.left.visible=!1})});var u=o.find(".tbt");0==u.length&&(u=t('<div class="tbt"></div>').appendTo(o));var c=u.children(".fa-remove");0==c.length&&(c=t('<i title=" " class="fa fa-remove"></i>').appendTo(u),c.on("click",function(t){t.stopPropagation(),t.preventDefault(),e.$apply(function(){r.left.visible=!1})}));var l=i.children(".collapser"),h=!1;0==l.length&&(h=!0,l=t('<div class="collapser"/>').prependTo(i),l.on("click",function(){e.$apply(function(){r.left.visible=!0})}));var f=i.children("ul");if(0==f.length){f=t('<ul class="hidden" the-menu >                        <li  ng-click="uistate.left.activate(o.code)" ng-repeat="o in uistate.left.objects | activeobjects ">                        {{o.title}}                    </li>                    </ul>'),f.appendTo(o);var d=n(f);d(e)}e.$watch(function(){return r.left.visible},function(e){i.toggleClass("collapsed",!e),h&&l.toggle(!e)}),e.$watch(function(){return r.left.getActive()},function(e){h&&l.text(e.title),a&&s.text(e.title),setTimeout(function(){i.children("[tool]").each(function(n,i){t(i).toggle(t(i).attr("tool")==e.code)})},100)})}}}]),i.directive("theErrors",[function(){return{restrict:"A",template:'<div class="messages">        <div class="message soft  bordered info" style="min-height: 40px" ng-click="log.hideAll()" ng-if="log.activemessages.length > 1">        <i  class="title success" >  </i>        <i class=" title success fa fa-remove"></i>        </div>        <div ng-click="m.expanded = !!!m.expanded" ng-dblclick="m.hide()" class="message bordered soft" ng-class="{expanded:m.expanded,warn:m.level==\'error\',info:m.level==\'info\'}" ng-repeat="m in log.activemessages">        : {{m.time}}, : {{m.action.url}}, : {{m.text}}        <i class="closer" ng-click="m.hide()"></i>        </div>        </div>'}}]),i.directive("theTab",[function(){return{restrict:"A",link:function(n,i,r){var o=r.theTab;i.addClass("maintoolbar"),i.addClass("tab"),n.$watch(function(){return e.uistate.toolbar.isActive(o)},function(e){e?t(i).show():t(i).hide()})}}}]),i.directive("theMenu",["dropdownService",function(e){function n(n,r){n.addClass("menuitem"),n.children("ul").exists()&&(n.addClass("submenu"),n.on("mouseenter",function(){var t={timeout:200==r,menu:!0,positions:["RD","RU","LD","LU"]};e(n,t)}),n.children("ul").each(function(e,n){i(t(n),r+1)}))}function i(r,o){r=t(r),"UL"==r[0].tagName.toUpperCase()?(r.addClass("dropdown"),r.addClass("menu")):r.on("mouseenter",function(){var t={menu:!0};e(r,t)}),t(r).children("li").each(function(e,i){n(t(i),o)}),t(r).children("ul").each(function(e,n){i(t(n),o)}),"UL"==r[0].tagName.toUpperCase()&&r.removeClass("hidden")}return{restrict:"A",compile:function(){return{pre:function(){},post:function(e,t){"UL"==t[0].tagName.toUpperCase()&&t.addClass("hidden"),setTimeout(function(){i(t,0)},100)}}}}}]),i.directive("theTabButton",[function(){return{restrict:"A",link:function(t,n,i){var r=i.theTabButton;n.addClass("button"),n.addClass("tab"),n.addClass("primary"),t.$watch(function(){return e.uistate.toolbar.isActive(r)},function(e){e?n.addClass("checked"):n.removeClass("checked")}),n.on("click",function(){t.$apply(function(){e.uistate.toolbar.activate(r)})})}}}])}}),define("the-print",["the-root"],function(e){return e(function(t){var n=t.printer=t.printer||{},i=t.printer.ServerPrinterOptions=function(){this.TargetUrl="",this.LocalizeUrl=!1,this.UrlParam="reporturl",this.PrintHash="print",this.CacheParam="cached",this.UseCache=!1,this.PrintCommand="print",this.BasePort=14075,this.DataUrl="",this.TitleParam="title",this.Title="",this.Target="_blank"},r=t.printer.PrinterOptions=function(){this.PrinterName="Bullzip PDF Printer",this.MarginTop=0,this.MarginBottom=0,this.MarginLeft=0,this.MarginRight=0,this.HeaderStrLeft="",this.HeaderStrCenter="",this.HeaderStrRight="",this.FooterStrLeft="",this.FooterStrCenter="",this.FooterStrRight="",this.ShrinkToFit=0,this.PrintBGColors=1,this.PrintBGImages=1};n.print=function(t){t=e.cast(r,t),jsPrintSetup.setPrinter(t.PrinterName),jsPrintSetup.clearSilentPrint(),jsPrintSetup.setSilentPrint(!0),jsPrintSetup.setOption("marginTop",t.MarginTop),jsPrintSetup.setOption("marginBottom",t.MarginBottom),jsPrintSetup.setOption("marginLeft",t.MarginLeft),jsPrintSetup.setOption("marginRight",t.MarginRight),jsPrintSetup.setOption("headerStrLeft",t.HeaderStrLeft),jsPrintSetup.setOption("headerStrCenter",t.HeaderStrCenter),jsPrintSetup.setOption("headerStrRight",t.HeaderStrRight),jsPrintSetup.setOption("footerStrLeft",t.FooterStrLeft),jsPrintSetup.setOption("footerStrCenter",t.FooterStrCenter),jsPrintSetup.setOption("footerStrRight",t.FooterStrRight),jsPrintSetup.setOption("footerStrRight",t.FooterStrRight),jsPrintSetup.setOption("shrinkToFit",t.ShrinkToFit),jsPrintSetup.setOption("printBGColors",t.PrintBGColors),jsPrintSetup.setOption("printBGImages",t.PrintBGImages),jsPrintSetup.print(),jsPrintSetup.setSilentPrint(!1)},n.serverPrint=function(t){t=e.cast(i,t);var n=t.Title||document.title,r=t.TargetUrl;if(!t.TargetUrl){var o="127.0.0.1"==document.location.hostname,s="https:"==document.location.protocol,a=t.BasePort;s&&(a+=1),o||(a-=5);var r=document.location.protocol+"//"+document.location.hostname+":"+a+"/"+t.PrintCommand}r.match(/\?/)||(r+="?"),t.UseCache&&(r+="&"+t.CacheParam+"=true"),r+="&"+t.TitleParam+"="+encodeURIComponent(n);var u=t.DataUrl;t.DataUrl||(u=document.location.protocol+"//"+(t.LocalizeUrl?"127.0.0.1":document.location.hostname)+":"+document.location.port+document.location.pathname+document.location.search+document.location.hash),u.match(/#/)||(u+="#"),t.PrintHash&&(u+="&"+t.PrintHash+"=true"),u=encodeURIComponent(u),r+="&"+t.UrlParam+"="+u,window.open(r,t.Target)}})}),define("the-dates",["the-object","moment"],function(e,t){return e(function(n){n.dates=n.dates||{};var i={i1:"",i2:"",i3:"",i4:"",i5:"",i6:"",i7:"",i8:"",i9:"",i10:"",i11:"",i12:"",r1:"",r2:"",r3:"",r4:"",r5:"",r6:"",r7:"",r8:"",r9:"",r10:"",r11:"",r12:""},r=(n.dates.toRusMonth=function(e,t){var n=0;if(t=t||"i",e)if("number"==typeof e)n=e;else if("string"==typeof e){if(n=Number(e),Number.isNaN(n))return e}else e instanceof Date&&(n=e.getMonth()+1);0==n&&(n=(new Date).getMonth()+1);var r=t+n;return i.hasOwnProperty(r)?i[r]:" "},n.dates.DEFAULT_DATE_FORMATS=["DD.MM.YYYY HH:mm:ss","YYYY-MM-DD HH:mm:ss","YYYYMMDDHHmmss","ddd, DD MMM YYYY HH:mm:ss ZZ"],n.dates.toDateFormat=function(e){return e=e||"ru","ru"==e?"DD.MM.YYYY":"RU"==e?"DD.MM.YYYY HH:mm:ss":"SQL"==e?"YYYYMMDD HH:mm:ss":"N"==e?"YYYYMMDDHHmmss":"RFC"==e?"ddd, DD MMM YYYY HH:mm:ss ZZ":e}),o=n.dates.toDate=function(e,t){if(!e)return null;if(e instanceof Date)return e;if("string"==typeof e){t=t||n.dates.DEFAULT_DATE_FORMATS,"string"==typeof t&&(t=[t]);for(var i=0;i<t.length;i++){var r=t[i],o=moment(e,r);if(o.isValid())return o.toDate()}return null}return null},s=n.dates.DateRange=function(){this.Basis=null,this.Start=null,this.Finish=null,this.Range="",this.IsValid=!1,this.SingleDate=!1,this.IsInfinity=!1};s.prototype.formatStart=function(e){return t(this.Start).format(r(e))},s.prototype.formatFinish=function(e){return t(this.Finish).format(r(e))},s.prototype.format=function(n,i){n=r(n);var o={single:" ${s}",ranged:" ${s}  ${f}",infinity:" "};i&&("string"==typeof i?o.ranged=i:Array.isArray(i)?(i.length>0&&(o.ranged=i[0]),i.length>1&&(o.single=i[1]),i.length>2&&(o.infinity=i[2])):e.extend(o,i));var s={b:t(this.Basis).format(n),s:this.formatStart(n),f:this.formatFinish(n),r:this.getRangeName()},a=o.ranged;return this.SingleDate&&!n.match(/HH/)?a=o.single:this.IsInfinity&&(a=o.infinity),e.interpolate(a,s)},s.GetRangeName=function(e){return"any"==e?"  ":"today"==e?" ":"yesterday"==e?" ":"-2d"==e?"  ":"-1w"==e?" ":"-1m"==e?" ":"-2m"==e?"  ":e},s.prototype.getRangeName=function(){return s.GetRangeName(this.Range)},s.create=function(t,n){n=o(n||new Date);var i=e.cast(s,{Basis:n,Range:t});return s.evaluate(i),i},s.parse=function(t,n){var i=e.hash.get;n=e.extend({UseRange:"userange",Range:"range",Start:"start",Finish:"finish",Basis:"today"},n);var r=Boolean(i(n.UseRange,t));if(r){var a=i(n.Range,t),u=o(i(n.Basis,t));return s.create(a,u)}var c=o(i(n.Start,t)),l=o(i(n.Finish,t)),h=new s;return h.IsValid=!0,h.Range="direct",h.Start=c,h.Finish=l,h},s.evaluate=function(e){if("any"==e.Range&&(e.IsValid=!0,e.IsInfinity=!0),"today"==e.Range){e.IsValid=!0;var n=t(e.Basis);return e.Finish=n.clone().endOf("day").toDate(),e.Start=n.clone().startOf("day").toDate(),void(e.SingleDate=!0)}if("yesterday"==e.Range){e.IsValid=!0;var n=t(e.Basis).add(-1,"days");return e.Start=n.clone().startOf("day").toDate(),e.Finish=n.clone().endOf("day").toDate(),void(e.SingleDate=!0)}var i=e.Range.match(/^\s*((-?)\d+)([hdmyw])\s*$/);if(i){e.IsValid=!0;var r=i[2],o=Number(i[1]),s=i[3];if("h"==s?s="hour":"d"==s?s="day":"m"==s?s="month":"y"==s?s="year":"w"==s&&(s="week"),e.Finish=e.Basis,0!=o)e.Start=t(e.Finish).add(o,s).toDate();else{var a="day";"hour"==s&&(a="hour"),r?(e.Finish=t(e.Finish).endOf(a).toDate(),e.Start=t(e.Finish).startOf(s).toDate()):(e.Start=t(e.Finish).startOf(a).toDate(),e.Finish=t(e.Finish).endOf(s).toDate())}e.Finish<e.Start&&(e.Finish=e.Start,e.Start=e.Basis),"hour"!=s&&0!=o&&(e.Start=t(e.Start).add(r?1:0,"day").startOf("day").toDate(),e.Finish=t(e.Finish).add(r?0:-1,"day").endOf("day").toDate()),t(e.Start).format("YYYYMMDD")==t(e.Finish).format("YYYYMMDD")&&(e.SingleDate=!0)}}})}),define("the-report",["the-object","the-hash"],function(e){return e(function(t){var n=t.hash,i=t.report=t.report||{};i.getDefaultContext=function(t,n,i,r){var o=e.hash.get,s=e.extend({showComments:!0,showExtensions:!0,numex:1,addr1:"",addr2:"",addr3:"",addr4:"",num:"",num2:"",advcomment:"",day:"",month:e.dates.toRusMonth(null,"r").toLowerCase()},t);if("undefined"==typeof n&&(n=!0),n){var a=o("numex",i,r);a&&(s.numex=a),s.addr1=o("addr1",i,r),s.addr2=o("addr2",i,r),s.addr3=o("addr3",i,r),s.addr4=o("addr4",i,r),s.num=o("num",i,r),s.num2=o("num2",i,r),s.advcomment=o("advcomment",i,r),s.day=o("day",i,r)||moment().date(),s.month=o("month",i,r)||s.month,s.showComments=!Boolean(o("noComments"),i,r),s.showExtensions=!Boolean(o("noExt"),i,r)}return s},i.setupDefaultScope=function(t){return t.state=e.report.getDefaultContext(),t.changed=function(e){n.set(e,t.state[e])},t.setShowComments=function(e){t.state.showComments=e,n.setFlag("noComments",!e)},t.setShowExtensions=function(e){t.state.showExtensions=e,n.setFlag("noExt",!e)},t.serverPrint=function(){e.printer.serverPrint({Target:"_blank"})},t.canPrint="undefined"!=typeof jsPrintSetup,t.doPrint=function(){setTimeout(function(){e.printer.print()},1e3)},t.state}})}),define("the-biz",["the-root"],function(e){return e(function(e){e.biz={toFio:function(e){if(!e)return e;var t="";return e.match(/^\s*[-]+\s+[-]+\s+[-]+\s*$/i)?t=e.replace(/^\s*([-]+)\s+([-])[-]+\s+([-])[-]+\s*$/i,"$1 $2.$3."):e.match(/^\s*[-]+\s+[-]+\s*$/i)&&(t=e.replace(/^\s*([-]+)\s+([-])[-]+\s*$/i,"$1 $2.")),t},translitTable:{"":"a","":"b","":"v","":"g","":"d","":"e","":"e","":"zh","":"z","":"i","":"y","":"k","":"l","":"m","":"n","":"o","":"p","":"r","":"s","":"t","":"u","":"f","":"h","":"ts","":"ch","":"sh","":"sh","":"","":"i","":"","":"e","":"yu","":"ya"},translit:function(e){if(e){var t="";for(i=0;i<e.length;i++){var n=e[i],r=n.toUpperCase()==n,o=n;if(r&&(o=n.toLowerCase()),this.translitTable.hasOwnProperty(o)){var s=this.translitTable[o];r&&(s=1==s.length?s.toUpperCase():s[0].toUpperCase()+s.substring(1)),t+=s}else t+=n}return t}},orgSysName:function(e){if(!e)return"";e=e.replace(/^\s*()|()|()|()|()|()\s+/,""),e=e.replace(/["'\-]/g,""),e=e.trim().toLowerCase(),e=e.replace(/\s+/g," ");var t=e.split(/ /);if(t.length<=2)return e=e.replace(/ /g,"_"),this.translit(e);for(var n=t[0]+"_",i=1;i<t.length;i++)n+=t[i][0];return this.translit(n)}}})}),define("the-rest2",["the-angular"],function(e){return e(function(t){t.modules.all.factory("the-rest2",["$http","$q",function(n,i){var r={},o={__prepareDefer:function(e){var t=i.defer();return t.promise.success=function(e){return t.promise.then(function(t){e(t.data,t.status,t.headers,t.config)})},t.promise.error=function(e){return t.promise.then(null,function(t){e(t.data,t.status,t.headers,t.config)})},e.success&&t.promise.success(e.success),t.promise["catch"](function(){e.onerror&&e.onerror(arguments)}),t},_globalwaiter:new Promise(function(e){e()}),setGlobalWaiter:function(e){this._globalwaiter=this._globalwaiter.then(e)},__executeHttp:function(e,t){return this._globalwaiter.then(function(){var i=e.getHttpOptions();return i.withCredentials=!0,n(i).success(function(n,i,r,o){t.resolve({data:n,status:i,headers:r,config:o,query:e})}).error(function(n,i,r,o){t.reject({data:n,status:i,headers:r,config:o,query:e})})})},executeCommand:function(t,n,i){t=e.cast(i,t,e.object.ExtendOptions.ExtendedCast);var o=this.__prepareDefer(t,n);if(t.timeout){var s=r[n]||(r[n]={}),a=t.awaiter||"default",u=s[a]||(s[a]={timeout:0,defered:null});u.timeout&&(clearTimeout(u.timeout),u.defered.reject({query:t,event:n,reasone:"override timeout"})),u.defered=o;var c=this;u.timeout=setTimeout(function(){c.__executeHttp(t,o)},t.timeout)}else this.__executeHttp(t,o);return o.promise}};return t.apibase=o,o}])})}),define("the-angular-initclient",["the-angular","the-rest2"],function(e){return e(function(t){t.modules.all.factory("the-initclient",["$http","the-rest2",function(t,n){var i={};return i.clientRequest=function(t){this.name=null,this.sysname=null,this.username=null,this.useremail=null,this.isdemo=!1,this.password=null,this.success=null,this.operation="init",this.expire=null,e.extend(this,t)},i.clientRequest.prototype.getHttpOptions=function(){return{url:"/client",method:"POST",data:e.jsonify(this,{nulls:!1,defaults:!1,functions:!1})}},i.initClient=function(e){return n.executeCommand(e,"initclient",i.clientRequest)},i.toWork=function(e){var t={sysname:e,operation:"towork"};return n.executeCommand(t,"towork",i.clientRequest)},i.toDemo=function(e){var t={sysname:e,operation:"todemo"};return n.executeCommand(t,"todemo",i.clientRequest)},i.setExpire=function(e,t){var r={sysname:e,operation:"setexpire",expire:t};return n.executeCommand(r,"setexpire",i.clientRequest)},i}])})}),define("the",["the-root","the-md5","the-object","the-interpolation","the-jsonify","the-http","the-expression","the-collections-core","the-collections-layered","the-collections-linked","the-collections-history","the-collections-linq","the-action","the-login","the-angular-unsafe","the-angular-autocomplete","the-angular-autoselect","the-angular-ellipse","the-angular-reports","the-angular-datetimepicker","the-angular-validation","the-uploader","the-angular-dialog","the-angular-controlgroup","the-angular-viewcontext","the-angular-onenter","the-design-stackedbutton","the-wiki","the-menu","the-settings","the-errorcatcher","the-refresh","autocomplete-html","the-domutils","the-dropdown","the-uistate","the-tools","the-print","the-dates","the-report","the-hash","the-biz","the-rest2","the-angular-initclient"],function(e,t){return e.md5=t,e}),define(["the"],function(e){return e});
//# sourceMappingURL=the.js
//# sourceMappingURL=the.js.map